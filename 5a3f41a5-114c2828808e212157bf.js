"use strict";(self.webpackChunkPeacasso=self.webpackChunkPeacasso||[]).push([[651],{7387:function(e,n,t){t.d(n,{AC:function(){return O},Rr:function(){return Vt},YH:function(){return Me},Z_:function(){return Ne},_K:function(){return Vn},ll:function(){return Kt},oI:function(){return $},oR:function(){return I},s_:function(){return Z},x$:function(){return Ht}});var o,r,i,a=t(9439),l=t(3433),d=t(4942),s=t(4925),c=t(5893),u=t(7294),g=t(6801),f=t(7084),v=t(4497),p=t(2095),h=t(272),m=t(8174),y=t(5011),x=t(302),S=(t(3935),["position","children","className","style"]),b=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"],C=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"],E=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","nodesFocusable","nodeOrigin","edgesFocusable","elementsSelectable","defaultViewport","minZoom","maxZoom","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneMouseEnter","onPaneMouseMove","onPaneMouseLeave","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect","disableKeyboardA11y","style","id"];function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){(0,d.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var M=(0,u.createContext)(null),P=M.Provider,k="[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#100";function I(e,n){var t=(0,u.useContext)(M);if(null===t)throw new Error(k);return(0,f.oR)(t,e,n)}var O=function(){var e=(0,u.useContext)(M);if(null===e)throw new Error(k);return(0,u.useMemo)((function(){return{getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}}),[e])},D=function(e){return e.userSelectionActive?"none":"all"};function Z(e){var n=e.position,t=e.children,o=e.className,r=e.style,i=(0,s.Z)(e,S),a=I(D),d="".concat(n).split("-");return(0,c.jsx)("div",N(N({className:(0,g.Z)(["react-flow__panel",o].concat((0,l.Z)(d))),style:N(N({},r),{},{pointerEvents:a})},i),{},{children:t}))}function A(e){var n=e.proOptions,t=e.position,o=void 0===t?"bottom-right":t;return null!=n&&n.hideAttribution?null:(0,c.jsx)(Z,{position:o,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,c.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}var B=(0,u.memo)((function(e){var n=e.x,t=e.y,o=e.label,r=e.labelStyle,i=void 0===r?{}:r,l=e.labelShowBg,d=void 0===l||l,f=e.labelBgStyle,v=void 0===f?{}:f,p=e.labelBgPadding,h=void 0===p?[2,4]:p,m=e.labelBgBorderRadius,y=void 0===m?2:m,x=e.children,S=e.className,C=(0,s.Z)(e,b),E=(0,u.useRef)(null),w=(0,u.useState)({x:0,y:0,width:0,height:0}),M=(0,a.Z)(w,2),P=M[0],k=M[1],I=(0,g.Z)(["react-flow__edge-textwrapper",S]);return(0,u.useEffect)((function(){if(E.current){var e=E.current.getBBox();k({x:e.x,y:e.y,width:e.width,height:e.height})}}),[o]),void 0!==o&&o?(0,c.jsxs)("g",N(N({transform:"translate(".concat(n-P.width/2," ").concat(t-P.height/2,")"),className:I,visibility:P.width?"visible":"hidden"},C),{},{children:[d&&(0,c.jsx)("rect",{width:P.width+2*h[0],x:-h[0],y:-h[1],height:P.height+2*h[1],className:"react-flow__edge-textbg",style:v,rx:y,ry:y}),(0,c.jsx)("text",{className:"react-flow__edge-text",y:P.height/2,dy:"0.3em",ref:E,style:i,children:o}),x]})):null})),L=function(e){var n=e.path,t=e.labelX,o=e.labelY,r=e.label,i=e.labelStyle,a=e.labelShowBg,l=e.labelBgStyle,d=e.labelBgPadding,s=e.labelBgBorderRadius,u=e.style,g=e.markerEnd,f=e.markerStart,v=e.interactionWidth,p=void 0===v?20:v;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("path",{style:u,d:n,fill:"none",className:"react-flow__edge-path",markerEnd:g,markerStart:f}),p&&(0,c.jsx)("path",{d:n,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),r?(0,c.jsx)(B,{x:t,y:o,label:r,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:s}):null]})};L.displayName="BaseEdge";var z,_;function j(e,n,t){return void 0===t?t:function(o){var r=n().edges.find((function(n){return n.id===e}));r&&t(o,N({},r))}}function R(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=Math.abs(o-n)/2,a=o<n?o+i:o-i,l=Math.abs(r-t)/2;return[a,r<t?r+l:r-l,i,l]}function T(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=e.sourceControlX,a=e.sourceControlY,l=.125*n+.375*i+.375*e.targetControlX+.125*o,d=.125*t+.375*a+.375*e.targetControlY+.125*r;return[l,d,Math.abs(l-n),Math.abs(d-t)]}!function(e){e.Strict="strict",e.Loose="loose"}(z||(z={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(_||(_={}));var Y,H,X,V=function(e){return{width:e.offsetWidth,height:e.offsetHeight}},K=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,n),t)},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},n=arguments.length>1?arguments[1]:void 0;return{x:K(e.x,n[0][0],n[1][0]),y:K(e.y,n[0][1],n[1][1])}},F=function(e){var n,t;return(null===(n=e.getRootNode)||void 0===n?void 0:n.call(e))||(null===(t=window)||void 0===t?void 0:t.document)},W=function(e,n){return{x:Math.min(e.x,n.x),y:Math.min(e.y,n.y),x2:Math.max(e.x2,n.x2),y2:Math.max(e.y2,n.y2)}},G=function(e){var n=e.x,t=e.y;return{x:n,y:t,x2:n+e.width,y2:t+e.height}},q=function(e){var n=e.x,t=e.y;return{x:n,y:t,width:e.x2-n,height:e.y2-t}},Q=function(e){return N(N({},e.positionAbsolute||{x:0,y:0}),{},{width:e.width||0,height:e.height||0})},$=function(e,n){return q(W(G(e),G(n)))},J=function(e,n){var t=Math.max(0,Math.min(e.x+e.width,n.x+n.width)-Math.max(e.x,n.x)),o=Math.max(0,Math.min(e.y+e.height,n.y+n.height)-Math.max(e.y,n.y));return Math.ceil(t*o)},ee=function(e){return!isNaN(e)&&isFinite(e)},ne=Symbol.for("internals"),te=["Enter"," ","Escape"],oe=function(e){0};function re(e){var n=e.pos,t=e.x1,o=e.y1,r=e.x2,i=e.y2;return n===X.Left||n===X.Right?[.5*(t+r),o]:[t,.5*(o+i)]}function ie(e){var n=e.sourceX,t=e.sourceY,o=e.sourcePosition,r=void 0===o?X.Bottom:o,i=e.targetX,l=e.targetY,d=e.targetPosition,s=void 0===d?X.Top:d,c=re({pos:r,x1:n,y1:t,x2:i,y2:l}),u=(0,a.Z)(c,2),g=u[0],f=u[1],v=re({pos:s,x1:i,y1:l,x2:n,y2:t}),p=(0,a.Z)(v,2),h=p[0],m=p[1],y=T({sourceX:n,sourceY:t,targetX:i,targetY:l,sourceControlX:g,sourceControlY:f,targetControlX:h,targetControlY:m}),x=(0,a.Z)(y,4),S=x[0],b=x[1],C=x[2],E=x[3];return["M".concat(n,",").concat(t," C").concat(g,",").concat(f," ").concat(h,",").concat(m," ").concat(i,",").concat(l),S,b,C,E]}!function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(Y||(Y={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(H||(H={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(X||(X={}));var ae=(0,u.memo)((function(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=e.sourcePosition,l=void 0===i?X.Bottom:i,d=e.targetPosition,s=void 0===d?X.Top:d,u=e.label,g=e.labelStyle,f=e.labelShowBg,v=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,m=e.style,y=e.markerEnd,x=e.markerStart,S=e.interactionWidth,b=ie({sourceX:n,sourceY:t,sourcePosition:l,targetX:o,targetY:r,targetPosition:s}),C=(0,a.Z)(b,3),E=C[0],w=C[1],N=C[2];return(0,c.jsx)(L,{path:E,labelX:w,labelY:N,label:u,labelStyle:g,labelShowBg:f,labelBgStyle:v,labelBgPadding:p,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:x,interactionWidth:S})}));ae.displayName="SimpleBezierEdge";var le=(o={},(0,d.Z)(o,X.Left,{x:-1,y:0}),(0,d.Z)(o,X.Right,{x:1,y:0}),(0,d.Z)(o,X.Top,{x:0,y:-1}),(0,d.Z)(o,X.Bottom,{x:0,y:1}),o),de=function(e,n){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))};function se(e){var n,t,o=e.source,r=e.sourcePosition,i=void 0===r?X.Bottom:r,d=e.target,s=e.targetPosition,c=void 0===s?X.Top:s,u=e.center,g=e.offset,f=le[i],v=le[c],p={x:o.x+f.x*g,y:o.y+f.y*g},h={x:d.x+v.x*g,y:d.y+v.y*g},m=function(e){var n=e.source,t=e.sourcePosition,o=void 0===t?X.Bottom:t,r=e.target;return o===X.Left||o===X.Right?n.x<r.x?{x:1,y:0}:{x:-1,y:0}:n.y<r.y?{x:0,y:1}:{x:0,y:-1}}({source:p,sourcePosition:i,target:h}),y=0!==m.x?"x":"y",x=m[y],S=[],b=R({sourceX:o.x,sourceY:o.y,targetX:d.x,targetY:d.y}),C=(0,a.Z)(b,4),E=C[0],w=C[1],N=C[2],M=C[3];if(f[y]*v[y]==-1){n=u.x||E,t=u.y||w;var P=[{x:n,y:p.y},{x:n,y:h.y}],k=[{x:p.x,y:t},{x:h.x,y:t}];S=f[y]===x?"x"===y?P:k:"x"===y?k:P}else{var I=[{x:p.x,y:h.y}],O=[{x:h.x,y:p.y}];if(S="x"===y?f.x===x?O:I:f.y===x?I:O,i!==c){var D="x"===y?"y":"x",Z=f[y]===v[D],A=p[D]>h[D],B=p[D]<h[D];(1===f[y]&&(!Z&&A||Z&&B)||1!==f[y]&&(!Z&&B||Z&&A))&&(S="x"===y?I:O)}n=S[0].x,t=S[0].y}return[[o,p].concat((0,l.Z)(S),[h,d]),n,t,N,M]}function ce(e){var n=e.sourceX,t=e.sourceY,o=e.sourcePosition,r=void 0===o?X.Bottom:o,i=e.targetX,l=e.targetY,d=e.targetPosition,s=void 0===d?X.Top:d,c=e.borderRadius,u=void 0===c?5:c,g=e.centerX,f=e.centerY,v=e.offset,p=se({source:{x:n,y:t},sourcePosition:r,target:{x:i,y:l},targetPosition:s,center:{x:g,y:f},offset:void 0===v?20:v}),h=(0,a.Z)(p,5),m=h[0],y=h[1],x=h[2],S=h[3],b=h[4];return[m.reduce((function(e,n,t){return e+=t>0&&t<m.length-1?function(e,n,t,o){var r=Math.min(de(e,n)/2,de(n,t)/2,o),i=n.x,a=n.y;if(e.x===i&&i===t.x||e.y===a&&a===t.y)return"L".concat(i," ").concat(a);if(e.y===a){var l=e.x<t.x?-1:1,d=e.y<t.y?1:-1;return"L ".concat(i+r*l,",").concat(a,"Q ").concat(i,",").concat(a," ").concat(i,",").concat(a+r*d)}var s=e.x<t.x?1:-1,c=e.y<t.y?-1:1;return"L ".concat(i,",").concat(a+r*c,"Q ").concat(i,",").concat(a," ").concat(i+r*s,",").concat(a)}(m[t-1],n,m[t+1],u):"".concat(0===t?"M":"L").concat(n.x," ").concat(n.y)}),""),y,x,S,b]}var ue=(0,u.memo)((function(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=e.label,l=e.labelStyle,d=e.labelShowBg,s=e.labelBgStyle,u=e.labelBgPadding,g=e.labelBgBorderRadius,f=e.style,v=e.sourcePosition,p=void 0===v?X.Bottom:v,h=e.targetPosition,m=void 0===h?X.Top:h,y=e.markerEnd,x=e.markerStart,S=e.pathOptions,b=e.interactionWidth,C=ce({sourceX:n,sourceY:t,sourcePosition:p,targetX:o,targetY:r,targetPosition:m,borderRadius:null==S?void 0:S.borderRadius,offset:null==S?void 0:S.offset}),E=(0,a.Z)(C,3),w=E[0],N=E[1],M=E[2];return(0,c.jsx)(L,{path:w,labelX:N,labelY:M,label:i,labelStyle:l,labelShowBg:d,labelBgStyle:s,labelBgPadding:u,labelBgBorderRadius:g,style:f,markerEnd:y,markerStart:x,interactionWidth:b})}));ue.displayName="SmoothStepEdge";var ge=(0,u.memo)((function(e){var n;return(0,c.jsx)(ue,N(N({},e),{},{pathOptions:(0,u.useMemo)((function(){var n;return{borderRadius:0,offset:null===(n=e.pathOptions)||void 0===n?void 0:n.offset}}),[null===(n=e.pathOptions)||void 0===n?void 0:n.offset])}))}));ge.displayName="StepEdge";var fe=(0,u.memo)((function(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=e.label,l=e.labelStyle,d=e.labelShowBg,s=e.labelBgStyle,u=e.labelBgPadding,g=e.labelBgBorderRadius,f=e.style,v=e.markerEnd,p=e.markerStart,h=e.interactionWidth,m=function(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=R({sourceX:n,sourceY:t,targetX:o,targetY:r}),l=(0,a.Z)(i,4),d=l[0],s=l[1],c=l[2],u=l[3];return["M ".concat(n,",").concat(t,"L ").concat(o,",").concat(r),d,s,c,u]}({sourceX:n,sourceY:t,targetX:o,targetY:r}),y=(0,a.Z)(m,3),x=y[0],S=y[1],b=y[2];return(0,c.jsx)(L,{path:x,labelX:S,labelY:b,label:i,labelStyle:l,labelShowBg:d,labelBgStyle:s,labelBgPadding:u,labelBgBorderRadius:g,style:f,markerEnd:v,markerStart:p,interactionWidth:h})}));function ve(e,n){return e>=0?.5*e:25*n*Math.sqrt(-e)}function pe(e){var n=e.pos,t=e.x1,o=e.y1,r=e.x2,i=e.y2,a=e.c;switch(n){case X.Left:return[t-ve(t-r,a),o];case X.Right:return[t+ve(r-t,a),o];case X.Top:return[t,o-ve(o-i,a)];case X.Bottom:return[t,o+ve(i-o,a)]}}function he(e){var n=e.sourceX,t=e.sourceY,o=e.sourcePosition,r=void 0===o?X.Bottom:o,i=e.targetX,l=e.targetY,d=e.targetPosition,s=void 0===d?X.Top:d,c=e.curvature,u=void 0===c?.25:c,g=pe({pos:r,x1:n,y1:t,x2:i,y2:l,c:u}),f=(0,a.Z)(g,2),v=f[0],p=f[1],h=pe({pos:s,x1:i,y1:l,x2:n,y2:t,c:u}),m=(0,a.Z)(h,2),y=m[0],x=m[1],S=T({sourceX:n,sourceY:t,targetX:i,targetY:l,sourceControlX:v,sourceControlY:p,targetControlX:y,targetControlY:x}),b=(0,a.Z)(S,4),C=b[0],E=b[1],w=b[2],N=b[3];return["M".concat(n,",").concat(t," C").concat(v,",").concat(p," ").concat(y,",").concat(x," ").concat(i,",").concat(l),C,E,w,N]}fe.displayName="StraightEdge";var me=(0,u.memo)((function(e){var n=e.sourceX,t=e.sourceY,o=e.targetX,r=e.targetY,i=e.sourcePosition,l=void 0===i?X.Bottom:i,d=e.targetPosition,s=void 0===d?X.Top:d,u=e.label,g=e.labelStyle,f=e.labelShowBg,v=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,m=e.style,y=e.markerEnd,x=e.markerStart,S=e.pathOptions,b=e.interactionWidth,C=he({sourceX:n,sourceY:t,sourcePosition:l,targetX:o,targetY:r,targetPosition:s,curvature:null==S?void 0:S.curvature}),E=(0,a.Z)(C,3),w=E[0],N=E[1],M=E[2];return(0,c.jsx)(L,{path:w,labelX:N,labelY:M,label:u,labelStyle:g,labelShowBg:f,labelBgStyle:v,labelBgPadding:p,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:x,interactionWidth:b})}));me.displayName="BezierEdge";var ye=(0,u.createContext)(null),xe=ye.Provider;function Se(e,n,t,o,r,i,a){var l=a.elementFromPoint(e.clientX,e.clientY),d=(null==l?void 0:l.classList.contains("target"))||!1,s=(null==l?void 0:l.classList.contains("source"))||!1,c={elementBelow:l,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(l&&(d||s)){c.isHoveringHandle=!0;var u=l.getAttribute("data-nodeid"),g=l.getAttribute("data-handleid"),f=t?{source:u,sourceHandle:g,target:o,targetHandle:r}:{source:o,sourceHandle:r,target:u,targetHandle:g};c.connection=f,(n!==z.Strict||(t&&s||!t&&d))&&(c.isValid=i(f))}return c}function be(e){null==e||e.classList.remove("react-flow__handle-valid"),null==e||e.classList.remove("react-flow__handle-connecting")}function Ce(e){var n=e.event,t=e.handleId,o=e.nodeId,r=e.onConnect,i=e.isTarget,a=e.getState,l=e.setState,d=e.isValidConnection,s=e.elementEdgeUpdaterType,c=e.onEdgeUpdateEnd,u=n.target.closest(".react-flow"),g=F(n.target);if(g){var f=g.elementFromPoint(n.clientX,n.clientY),v=null==f?void 0:f.classList.contains("target"),p=null==f?void 0:f.classList.contains("source");if(u&&(v||p||s)){var h,m=a(),y=m.onConnectStart,x=m.connectionMode,S=s||(v?"target":"source"),b=u.getBoundingClientRect();l({connectionPosition:{x:n.clientX-b.left,y:n.clientY-b.top},connectionNodeId:o,connectionHandleId:t,connectionHandleType:S}),null==y||y(n,{nodeId:o,handleId:t,handleType:S}),g.addEventListener("mousemove",C),g.addEventListener("mouseup",(function e(n){var u,f,v=Se(n,x,i,o,t,d,g),p=v.connection;v.isValid&&(null==r||r(p)),null===(u=(f=a()).onConnectEnd)||void 0===u||u.call(f,n),s&&c&&c(n),be(h),l({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),g.removeEventListener("mousemove",C),g.removeEventListener("mouseup",e)}))}}function C(e){l({connectionPosition:{x:e.clientX-b.left,y:e.clientY-b.top}});var n=Se(e,x,i,o,t,d,g),r=n.connection,a=n.elementBelow,s=n.isValid;if(!n.isHoveringHandle)return be(h);r.source!==r.target&&a&&(be(h),h=a,a.classList.add("react-flow__handle-connecting"),a.classList.toggle("react-flow__handle-valid",s))}}ye.Consumer;var Ee=function(e){var n=e.source,t=e.sourceHandle,o=e.target,r=e.targetHandle;return"reactflow__edge-".concat(n).concat(t||"","-").concat(o).concat(r||"")},we=function(e,n){if(void 0===e)return"";if("string"==typeof e)return e;var t=n?"".concat(n,"__"):"";return"".concat(t).concat(Object.keys(e).sort().map((function(n){return"".concat(n,"=").concat(e[n])})).join("&"))},Ne=function(e,n){return e.source&&e.target?function(e,n){return n.some((function(n){return!(n.source!==e.source||n.target!==e.target||n.sourceHandle!==e.sourceHandle&&(n.sourceHandle||e.sourceHandle)||n.targetHandle!==e.targetHandle&&(n.targetHandle||e.targetHandle))}))}(t="id"in(o=e)&&"source"in o&&"target"in o?N({},e):N(N({},e),{},{id:Ee(e)}),n)?n:n.concat(t):(oe(),n);var t,o},Me=function(e){if(0===e.length)return{x:0,y:0,width:0,height:0};var n=e.reduce((function(e,n){var t=n.positionAbsolute,o=n.position,r=n.width,i=n.height;return W(e,G({x:t?t.x:o.x,y:t?t.y:o.y,width:r||0,height:i||0}))}),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return q(n)},Pe=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],o=(0,a.Z)(t,3),r=o[0],i=o[1],l=o[2],d=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c={x:(n.x-r)/l,y:(n.y-i)/l,width:n.width/l,height:n.height/l},u=[];return e.forEach((function(e){var n=e.positionAbsolute,t=void 0===n?{x:0,y:0}:n,o=e.width,r=e.height,i=e.selectable;if(s&&!(void 0===i||i))return!1;var a=N(N({},t),{},{width:o||0,height:r||0}),l=J(c,a);(void 0===o||void 0===r||null===o||null===r||d&&l>0||l>=(o||0)*(r||0)||e.dragging)&&u.push(e)})),u},ke=function(e,n){var t=e.map((function(e){return e.id}));return n.filter((function(e){return t.includes(e.source)||t.includes(e.target)}))},Ie=function(e,n,t,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.1,a=n/(e.width*(1+i)),l=t/(e.height*(1+i)),d=Math.min(a,l),s=K(d,o,r),c=e.x+e.width/2,u=e.y+e.height/2,g=n/2-c*s,f=t/2-u*s;return[g,f,s]},Oe=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.transition().duration(n)},De=function(){return!0},Ze=function(e){return{connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}},Ae=(0,u.forwardRef)((function(e,n){var t=e.type,o=void 0===t?"source":t,r=e.position,i=void 0===r?X.Top:r,a=e.isValidConnection,l=void 0===a?De:a,d=e.isConnectable,f=void 0===d||d,v=e.id,h=e.onConnect,m=e.children,y=e.className,x=e.onMouseDown,S=(0,s.Z)(e,C),b=O(),E=(0,u.useContext)(ye),w=I(Ze,p.Z),M=w.connectionStartHandle,P=w.connectOnClick,k=w.noPanClassName,D=v||null,Z="target"===o,A=function(e){var n=b.getState(),t=n.defaultEdgeOptions,o=n.onConnect,r=n.hasDefaultEdges,i=N(N({},t),e);if(r){var a=b.getState().edges;b.setState({edges:Ne(i,a)})}null==o||o(i),null==h||h(i)};return(0,c.jsx)("div",N(N({"data-handleid":D,"data-nodeid":E,"data-handlepos":i,className:(0,g.Z)(["react-flow__handle","react-flow__handle-".concat(i),"nodrag",k,y,{source:!Z,target:Z,connectable:f,connecting:(null==M?void 0:M.nodeId)===E&&(null==M?void 0:M.handleId)===D&&(null==M?void 0:M.type)===o}]),onMouseDown:function(e){0===e.button&&Ce({event:e,handleId:D,nodeId:E,onConnect:A,isTarget:Z,getState:b.getState,setState:b.setState,isValidConnection:l}),null==x||x(e)},onClick:P?function(e){var n=b.getState(),t=n.onClickConnectStart,r=n.onClickConnectEnd,i=n.connectionMode;if(!M)return null==t||t(e,{nodeId:E,handleId:D,handleType:o}),void b.setState({connectionStartHandle:{nodeId:E,type:o,handleId:D}});var a=F(e.target),d=Se(e,i,"target"===M.type,M.nodeId,M.handleId||null,l,a),s=d.connection;d.isValid&&A(s),null==r||r(e),b.setState({connectionStartHandle:null})}:void 0,ref:n},S),{},{children:m}))}));Ae.displayName="Handle";var Be=(0,u.memo)(Ae),Le=function(e){var n=e.data,t=e.isConnectable,o=e.targetPosition,r=void 0===o?X.Top:o,i=e.sourcePosition,a=void 0===i?X.Bottom:i;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Be,{type:"target",position:r,isConnectable:t}),null==n?void 0:n.label,(0,c.jsx)(Be,{type:"source",position:a,isConnectable:t})]})};Le.displayName="DefaultNode";var ze=(0,u.memo)(Le),_e=function(e){var n=e.data,t=e.isConnectable,o=e.sourcePosition,r=void 0===o?X.Bottom:o;return(0,c.jsxs)(c.Fragment,{children:[null==n?void 0:n.label,(0,c.jsx)(Be,{type:"source",position:r,isConnectable:t})]})};_e.displayName="InputNode";var je=(0,u.memo)(_e),Re=function(e){var n=e.data,t=e.isConnectable,o=e.targetPosition,r=void 0===o?X.Top:o;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Be,{type:"target",position:r,isConnectable:t}),null==n?void 0:n.label]})};Re.displayName="OutputNode";var Te=(0,u.memo)(Re),Ye=function(){return null};Ye.displayName="GroupNode";var He=function(e){return{selectedNodes:Array.from(e.nodeInternals.values()).filter((function(e){return e.selected})),selectedEdges:e.edges.filter((function(e){return e.selected}))}},Xe=function(e){return e.id};function Ve(e,n){return(0,p.Z)(e.selectedNodes.map(Xe),n.selectedNodes.map(Xe))&&(0,p.Z)(e.selectedEdges.map(Xe),n.selectedEdges.map(Xe))}var Ke=(0,u.memo)((function(e){var n=e.onSelectionChange,t=O(),o=I(He,Ve),r=o.selectedNodes,i=o.selectedEdges;return(0,u.useEffect)((function(){var e,o,a={nodes:r,edges:i};null==n||n(a),null===(e=(o=t.getState()).onSelectionChange)||void 0===e||e.call(o,a)}),[r,i,n]),null}));Ke.displayName="SelectionListener";var Ue=function(e){return!!e.onSelectionChange};function Fe(e){var n=e.onSelectionChange,t=I(Ue);return n||t?(0,c.jsx)(Ke,{onSelectionChange:n}):null}var We=function(e){return{setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset}};function Ge(e,n){(0,u.useEffect)((function(){void 0!==e&&n(e)}),[e])}function qe(e,n,t){(0,u.useEffect)((function(){void 0!==n&&t((0,d.Z)({},e,n))}),[n])}var Qe=function(e){var n=e.nodes,t=e.edges,o=e.defaultNodes,r=e.defaultEdges,i=e.onConnect,a=e.onConnectStart,l=e.onConnectEnd,d=e.onClickConnectStart,s=e.onClickConnectEnd,c=e.nodesDraggable,g=e.nodesConnectable,f=e.nodesFocusable,v=e.edgesFocusable,h=e.minZoom,m=e.maxZoom,y=e.nodeExtent,x=e.onNodesChange,S=e.onEdgesChange,b=e.elementsSelectable,C=e.connectionMode,E=e.snapGrid,w=e.snapToGrid,M=e.translateExtent,P=e.connectOnClick,k=e.defaultEdgeOptions,D=e.fitView,Z=e.fitViewOptions,A=e.onNodesDelete,B=e.onEdgesDelete,L=e.onNodeDrag,z=e.onNodeDragStart,_=e.onNodeDragStop,j=e.onSelectionDrag,R=e.onSelectionDragStart,T=e.onSelectionDragStop,Y=e.noPanClassName,H=e.nodeOrigin,X=e.rfId,V=I(We,p.Z),K=V.setNodes,U=V.setEdges,F=V.setDefaultNodesAndEdges,W=V.setMinZoom,G=V.setMaxZoom,q=V.setTranslateExtent,Q=V.setNodeExtent,$=V.reset,J=O();return(0,u.useEffect)((function(){var e=null==r?void 0:r.map((function(e){return N(N({},e),k)}));return F(o,e),function(){$()}}),[]),qe("defaultEdgeOptions",k,J.setState),qe("connectionMode",C,J.setState),qe("onConnect",i,J.setState),qe("onConnectStart",a,J.setState),qe("onConnectEnd",l,J.setState),qe("onClickConnectStart",d,J.setState),qe("onClickConnectEnd",s,J.setState),qe("nodesDraggable",c,J.setState),qe("nodesConnectable",g,J.setState),qe("nodesFocusable",f,J.setState),qe("edgesFocusable",v,J.setState),qe("elementsSelectable",b,J.setState),qe("snapToGrid",w,J.setState),qe("snapGrid",E,J.setState),qe("onNodesChange",x,J.setState),qe("onEdgesChange",S,J.setState),qe("connectOnClick",P,J.setState),qe("fitViewOnInit",D,J.setState),qe("fitViewOnInitOptions",Z,J.setState),qe("onNodesDelete",A,J.setState),qe("onEdgesDelete",B,J.setState),qe("onNodeDrag",L,J.setState),qe("onNodeDragStart",z,J.setState),qe("onNodeDragStop",_,J.setState),qe("onSelectionDrag",j,J.setState),qe("onSelectionDragStart",R,J.setState),qe("onSelectionDragStop",T,J.setState),qe("noPanClassName",Y,J.setState),qe("nodeOrigin",H,J.setState),qe("rfId",X,J.setState),Ge(n,K),Ge(t,U),Ge(h,W),Ge(m,G),Ge(M,q),Ge(y,Q),null},$e={display:"none"},Je={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},en="react-flow__node-desc",nn="react-flow__edge-desc",tn=function(e){return e.ariaLiveMessage};function on(e){var n=e.rfId,t=I(tn);return(0,c.jsx)("div",{id:"".concat("react-flow__aria-live","-").concat(n),"aria-live":"assertive","aria-atomic":"true",style:Je,children:t})}function rn(e){var n=e.rfId,t=e.disableKeyboardA11y;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{id:"".concat(en,"-").concat(n),style:$e,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,c.jsx)("div",{id:"".concat(nn,"-").concat(n),style:$e,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&(0,c.jsx)(on,{rfId:n})]})}var an=function(e,n,t){return t===X.Left?e-n:t===X.Right?e+n:e},ln=function(e,n,t){return t===X.Top?e-n:t===X.Bottom?e+n:e},dn="react-flow__edgeupdater",sn=function(e){var n=e.position,t=e.centerX,o=e.centerY,r=e.radius,i=void 0===r?10:r,a=e.onMouseDown,l=e.onMouseEnter,d=e.onMouseOut,s=e.type;return(0,c.jsx)("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:d,className:(0,g.Z)([dn,"".concat(dn,"-").concat(s)]),cx:an(t,i,n),cy:ln(o,i,n),r:i,stroke:"transparent",fill:"transparent"})},cn=function(e){var n=function(n){var t=n.id,o=n.className,r=n.type,i=n.data,l=n.onClick,d=n.onEdgeDoubleClick,s=n.selected,f=n.animated,v=n.label,p=n.labelStyle,h=n.labelShowBg,m=n.labelBgStyle,y=n.labelBgPadding,x=n.labelBgBorderRadius,S=n.style,b=n.source,C=n.target,E=n.sourceX,w=n.sourceY,N=n.targetX,M=n.targetY,P=n.sourcePosition,k=n.targetPosition,I=n.elementsSelectable,D=n.hidden,Z=n.sourceHandleId,A=n.targetHandleId,B=n.onContextMenu,L=n.onMouseEnter,z=n.onMouseMove,_=n.onMouseLeave,R=n.edgeUpdaterRadius,T=n.onEdgeUpdate,Y=n.onEdgeUpdateStart,H=n.onEdgeUpdateEnd,X=n.markerEnd,V=n.markerStart,K=n.rfId,U=n.ariaLabel,F=n.isFocusable,W=n.pathOptions,G=n.interactionWidth,q=(0,u.useRef)(null),Q=(0,u.useState)(!1),$=(0,a.Z)(Q,2),J=$[0],ee=$[1],ne=(0,u.useState)(!1),oe=(0,a.Z)(ne,2),re=oe[0],ie=oe[1],ae=O(),le=(0,u.useMemo)((function(){return"url(#".concat(we(V,K),")")}),[V,K]),de=(0,u.useMemo)((function(){return"url(#".concat(we(X,K),")")}),[X,K]);if(D)return null;var se=j(t,ae.getState,d),ce=j(t,ae.getState,B),ue=j(t,ae.getState,L),ge=j(t,ae.getState,z),fe=j(t,ae.getState,_),ve=function(e,n){var o=n?C:b,r=(n?A:Z)||null,i=n?"target":"source",a=n,l=ae.getState().edges.find((function(e){return e.id===t}));ie(!0),null==Y||Y(e,l,i);Ce({event:e,handleId:r,nodeId:o,onConnect:function(e){return null==T?void 0:T(l,e)},isTarget:a,getState:ae.getState,setState:ae.setState,isValidConnection:function(){return!0},elementEdgeUpdaterType:i,onEdgeUpdateEnd:function(e){ie(!1),null==H||H(e,l,i)}})},pe=function(){return ee(!0)},he=function(){return ee(!1)},me=!I&&!l,ye=void 0!==T;return(0,c.jsxs)("g",{className:(0,g.Z)(["react-flow__edge","react-flow__edge-".concat(r),o,{selected:s,animated:f,inactive:me,updating:J}]),onClick:function(e){var n=ae.getState(),o=n.edges,r=n.addSelectedEdges;if(I&&(ae.setState({nodesSelectionActive:!1}),r([t])),l){var i=o.find((function(e){return e.id===t}));l(e,i)}},onDoubleClick:se,onContextMenu:ce,onMouseEnter:ue,onMouseMove:ge,onMouseLeave:fe,onKeyDown:F?function(e){if(te.includes(e.key)&&I){var n,o=ae.getState(),r=o.unselectNodesAndEdges,i=o.addSelectedEdges,a=o.edges;if("Escape"===e.key)null===(n=q.current)||void 0===n||n.blur(),r({edges:[a.find((function(e){return e.id===t}))]});else i([t])}}:void 0,tabIndex:F?0:void 0,role:F?"button":void 0,"data-testid":"rf__edge-".concat(t),"aria-label":null===U?void 0:U||"Edge from ".concat(b," to ").concat(C),"aria-describedby":F?"".concat(nn,"-").concat(K):void 0,ref:q,children:[!re&&(0,c.jsx)(e,{id:t,source:b,target:C,selected:s,animated:f,label:v,labelStyle:p,labelShowBg:h,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:x,data:i,style:S,sourceX:E,sourceY:w,targetX:N,targetY:M,sourcePosition:P,targetPosition:k,sourceHandleId:Z,targetHandleId:A,markerStart:le,markerEnd:de,pathOptions:W,interactionWidth:G}),ye&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sn,{position:P,centerX:E,centerY:w,radius:R,onMouseDown:function(e){return ve(e,!0)},onMouseEnter:pe,onMouseOut:he,type:"source"}),(0,c.jsx)(sn,{position:k,centerX:N,centerY:M,radius:R,onMouseDown:function(e){return ve(e,!1)},onMouseEnter:pe,onMouseOut:he,type:"target"})]})]})};return n.displayName="EdgeWrapper",(0,u.memo)(n)};function un(e){var n={default:cn(e.default||me),straight:cn(e.bezier||fe),step:cn(e.step||ge),smoothstep:cn(e.step||ue),simplebezier:cn(e.simplebezier||ae)},t=Object.keys(e).filter((function(e){return!["default","bezier"].includes(e)})).reduce((function(n,t){return n[t]=cn(e[t]||me),n}),{});return N(N({},n),t)}function gn(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=((null==t?void 0:t.x)||0)+n.x,r=((null==t?void 0:t.y)||0)+n.y,i=(null==t?void 0:t.width)||n.width,a=(null==t?void 0:t.height)||n.height;switch(e){case X.Top:return{x:o+i/2,y:r};case X.Right:return{x:o+i,y:r+a/2};case X.Bottom:return{x:o+i/2,y:r+a};case X.Left:return{x:o,y:r+a/2}}}function fn(e,n){if(!e)return null;var t=null;return 1!==e.length&&n?n&&(t=e.find((function(e){return e.id===n}))):t=e[0],void 0===t?null:t}function vn(e){var n,t,o,r,i,a=(null==e||null===(n=e[ne])||void 0===n?void 0:n.handleBounds)||null,l=!(e&&a&&e.width&&e.height&&void 0!==(null===(t=e.positionAbsolute)||void 0===t?void 0:t.x)&&void 0!==(null===(o=e.positionAbsolute)||void 0===o?void 0:o.y));return[{x:(null==e||null===(r=e.positionAbsolute)||void 0===r?void 0:r.x)||0,y:(null==e||null===(i=e.positionAbsolute)||void 0===i?void 0:i.y)||0,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0},a,!l]}function pn(e,n){if(!e.parentNode)return!1;var t=n.get(e.parentNode);return!!t&&(!!t.selected||pn(t,n))}function hn(e,n,t){var o=e;do{var r;if(null!==(r=o)&&void 0!==r&&r.matches(n))return!0;if(o===t.current)return!1;o=o.parentElement}while(o);return!1}function mn(e,n,t){return Array.from(e.values()).filter((function(n){return(n.selected||n.id===t)&&(!n.parentNode||!pn(n,e))})).map((function(e){var t,o,r,i;return{id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(null!==(t=null===(o=e.positionAbsolute)||void 0===o?void 0:o.x)&&void 0!==t?t:0),y:n.y-(null!==(r=null===(i=e.positionAbsolute)||void 0===i?void 0:i.y)&&void 0!==r?r:0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode,width:e.width,height:e.height}}))}function yn(e,n,t,o){var r=e.extent||o;if("parent"===e.extent)if(e.parentNode&&e.width&&e.height){var i=t.get(e.parentNode);r=null!=i&&i.positionAbsolute&&null!=i&&i.width&&null!=i&&i.height?[[i.positionAbsolute.x,i.positionAbsolute.y],[i.positionAbsolute.x+i.width-e.width,i.positionAbsolute.y+i.height-e.height]]:r}else oe(),r=o;else if(e.extent&&e.parentNode){var a,l,d,s,c=t.get(e.parentNode),u=null!==(a=null==c||null===(l=c.positionAbsolute)||void 0===l?void 0:l.x)&&void 0!==a?a:0,g=null!==(d=null==c||null===(s=c.positionAbsolute)||void 0===s?void 0:s.y)&&void 0!==d?d:0;r=[[e.extent[0][0]+u,e.extent[0][1]+g],[e.extent[1][0]+u,e.extent[1][1]+g]]}var f={x:0,y:0};if(e.parentNode){var v,p,h,m,y=t.get(e.parentNode);f={x:null!==(v=null==y||null===(p=y.positionAbsolute)||void 0===p?void 0:p.x)&&void 0!==v?v:0,y:null!==(h=null==y||null===(m=y.positionAbsolute)||void 0===m?void 0:m.y)&&void 0!==h?h:0}}var x=r?U(n,r):n;return{position:{x:x.x-f.x,y:x.y-f.y},positionAbsolute:x}}function xn(e){var n=e.nodeId,t=e.dragItems,o=e.nodeInternals,r=t.map((function(e){return N(N({},o.get(e.id)),{},{position:e.position,positionAbsolute:e.positionAbsolute})}));return[n?r.find((function(e){return e.id===n})):r[0],r]}var Sn=function(e,n,t,o){var r=n.querySelectorAll(e);if(!r||!r.length)return null;var i=Array.from(r),a=n.getBoundingClientRect(),l=a.width*o[0],d=a.height*o[1];return i.map((function(e){var n=e.getBoundingClientRect();return N({id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(n.left-a.left-l)/t,y:(n.top-a.top-d)/t},V(e))}))};function bn(e,n,t){return void 0===t?t:function(o){var r=n().nodeInternals.get(e);t(o,N({},r))}}function Cn(e){var n=e.id,t=e.store,o=e.unselect,r=void 0!==o&&o,i=t.getState(),a=i.addSelectedNodes,l=i.unselectNodesAndEdges,d=i.multiSelectionActive,s=i.nodeInternals.get(n);t.setState({nodesSelectionActive:!1}),s.selected?(r||s.selected&&d)&&l({nodes:[s]}):a([n])}function En(e){return function(n,t,o){return null==e?void 0:e(n,o)}}function wn(e){var n=e.nodeRef,t=e.disabled,o=void 0!==t&&t,r=e.noDragClassName,i=e.handleSelector,l=e.nodeId,d=e.isSelectable,s=e.selectNodesOnDrag,c=(0,u.useState)(!1),g=(0,a.Z)(c,2),f=g[0],v=g[1],p=O(),y=(0,u.useRef)(),x=(0,u.useRef)({x:null,y:null}),S=(0,u.useCallback)((function(e){var n=e.sourceEvent,t=p.getState(),o=t.transform,r=t.snapGrid,i=t.snapToGrid,a=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,d={x:(a-o[0])/o[2],y:(l-o[1])/o[2]};return N({xSnapped:i?r[0]*Math.round(d.x/r[0]):d.x,ySnapped:i?r[1]*Math.round(d.y/r[1]):d.y},d)}),[]);return(0,u.useEffect)((function(){if(null!=n&&n.current){var e=(0,m.Z)(n.current);if(!o){var t=(0,h.Z)().on("start",(function(e){var n,t=p.getState(),o=t.nodeInternals,r=t.multiSelectionActive,i=t.unselectNodesAndEdges,c=t.onNodeDragStart,u=t.onSelectionDragStart,g=l?c:En(u);s||r||!l||(null!==(n=o.get(l))&&void 0!==n&&n.selected||i());l&&d&&s&&Cn({id:l,store:p});var f=S(e);if(x.current=f,y.current=mn(o,f,l),g&&y.current){var v=xn({nodeId:l,dragItems:y.current,nodeInternals:o}),h=(0,a.Z)(v,2),m=h[0],b=h[1];g(e.sourceEvent,m,b)}})).on("drag",(function(e){var n=p.getState(),t=n.updateNodePositions,o=n.nodeInternals,r=n.nodeExtent,i=n.onNodeDrag,d=n.onSelectionDrag,s=n.snapGrid,c=n.snapToGrid,u=S(e);if((x.current.x!==u.xSnapped||x.current.y!==u.ySnapped)&&y.current){x.current={x:u.xSnapped,y:u.ySnapped},y.current=y.current.map((function(e){var n={x:u.x-e.distance.x,y:u.y-e.distance.y};c&&(n.x=s[0]*Math.round(n.x/s[0]),n.y=s[1]*Math.round(n.y/s[1]));var t=yn(e,n,o,r);return e.position=t.position,e.positionAbsolute=t.positionAbsolute,e}));var g=l?i:En(d);if(t(y.current,!0,!0),v(!0),g){var f=xn({nodeId:l,dragItems:y.current,nodeInternals:o}),h=(0,a.Z)(f,2),m=h[0],b=h[1];g(e.sourceEvent,m,b)}}})).on("end",(function(e){if(v(!1),y.current){var n=p.getState(),t=n.updateNodePositions,o=n.nodeInternals,r=n.onNodeDragStop,i=n.onSelectionDragStop,d=l?r:En(i);if(t(y.current,!1,!1),d){var s=xn({nodeId:l,dragItems:y.current,nodeInternals:o}),c=(0,a.Z)(s,2),u=c[0],g=c[1];d(e.sourceEvent,u,g)}}})).filter((function(e){var t=e.target;return!e.button&&(!r||!hn(t,".".concat(r),n))&&(!i||hn(t,i,n))}));return e.call(t),function(){e.on(".drag",null)}}e.on(".drag",null)}}),[n,o,r,i,d,p,l,s,S]),f}function Nn(){var e=O();return(0,u.useCallback)((function(n){var t=e.getState(),o=t.nodeInternals,r=t.nodeExtent,i=t.updateNodePositions,a=t.snapToGrid,l=t.snapGrid;i(Array.from(o.values()).filter((function(e){return e.selected})).map((function(e){if(e.positionAbsolute){var t={x:e.positionAbsolute.x+n.x,y:e.positionAbsolute.y+n.y};a&&(t.x=l[0]*Math.round(t.x/l[0]),t.y=l[1]*Math.round(t.y/l[1]));var i=yn(e,t,o,r);e.position=i.position,e.positionAbsolute=i.positionAbsolute}return e})),!0,!0)}),[])}var Mn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Pn=function(e){var n=function(n){var t=n.id,o=n.type,r=n.data,i=n.xPos,a=n.yPos,l=n.xPosOrigin,s=n.yPosOrigin,f=n.selected,v=n.onClick,p=n.onMouseEnter,h=n.onMouseMove,m=n.onMouseLeave,y=n.onContextMenu,x=n.onDoubleClick,S=n.style,b=n.className,C=n.isDraggable,E=n.isSelectable,w=n.isConnectable,M=n.isFocusable,P=n.selectNodesOnDrag,k=n.sourcePosition,I=n.targetPosition,D=n.hidden,Z=n.resizeObserver,A=n.dragHandle,B=n.zIndex,L=n.isParent,z=n.noDragClassName,_=n.noPanClassName,j=n.initialized,R=n.disableKeyboardA11y,T=n.ariaLabel,Y=n.rfId,H=O(),X=(0,u.useRef)(null),V=(0,u.useRef)(k),K=(0,u.useRef)(I),U=(0,u.useRef)(o),F=E||C||v||p||h||m,W=Nn(),G=bn(t,H.getState,p),q=bn(t,H.getState,h),Q=bn(t,H.getState,m),$=bn(t,H.getState,y),J=bn(t,H.getState,x);(0,u.useEffect)((function(){if(X.current&&!D){var e=X.current;return null==Z||Z.observe(e),function(){return null==Z?void 0:Z.unobserve(e)}}}),[D]),(0,u.useEffect)((function(){var e=U.current!==o,n=V.current!==k,r=K.current!==I;X.current&&(e||n||r)&&(e&&(U.current=o),n&&(V.current=k),r&&(K.current=I),H.getState().updateNodeDimensions([{id:t,nodeElement:X.current,forceUpdate:!0}]))}),[t,o,k,I]);var ee=wn({nodeRef:X,disabled:D||!C,noDragClassName:z,handleSelector:A,nodeId:t,isSelectable:E,selectNodesOnDrag:P});return D?null:(0,c.jsx)("div",{className:(0,g.Z)(["react-flow__node","react-flow__node-".concat(o),(0,d.Z)({},_,C),b,{selected:f,selectable:E,parent:L,dragging:ee}]),ref:X,style:N({zIndex:B,transform:"translate(".concat(l,"px,").concat(s,"px)"),pointerEvents:F?"all":"none",visibility:j?"visible":"hidden"},S),"data-id":t,"data-testid":"rf__node-".concat(t),onMouseEnter:G,onMouseMove:q,onMouseLeave:Q,onContextMenu:$,onClick:function(e){if(!E||P&&C||Cn({id:t,store:H}),v){var n=H.getState().nodeInternals.get(t);v(e,N({},n))}},onDoubleClick:J,onKeyDown:M?function(e){var n=H.getState(),o=n.snapGrid,r=n.snapToGrid;if(te.includes(e.key)&&E){var l,d="Escape"===e.key;if(d)null===(l=X.current)||void 0===l||l.blur();Cn({id:t,store:H,unselect:d})}else if(!R&&C&&f&&Object.prototype.hasOwnProperty.call(Mn,e.key)){H.setState({ariaLiveMessage:"Moved selected node ".concat(e.key.replace("Arrow","").toLowerCase(),". New position, x: ").concat(~~i,", y: ").concat(~~a)});var s=r?o[0]:5,c=r?o[1]:5,u=e.shiftKey?4:1;W({x:Mn[e.key].x*s*u,y:Mn[e.key].y*c*u})}}:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":R?void 0:"".concat(en,"-").concat(Y),"aria-label":T,children:(0,c.jsx)(xe,{value:t,children:(0,c.jsx)(e,{id:t,data:r,type:o,xPos:i,yPos:a,selected:f,isConnectable:w,sourcePosition:k,targetPosition:I,dragging:ee,dragHandle:A,zIndex:B})})})};return n.displayName="NodeWrapper",(0,u.memo)(n)};function kn(e){var n={input:Pn(e.input||je),default:Pn(e.default||ze),output:Pn(e.output||Te),group:Pn(e.group||Ye)},t=Object.keys(e).filter((function(e){return!["input","default","output","group"].includes(e)})).reduce((function(n,t){return n[t]=Pn(e[t]||ze),n}),{});return N(N({},n),t)}var In="undefined"!=typeof document?document:null,On=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{target:In},t=(0,u.useState)(!1),o=(0,a.Z)(t,2),r=o[0],i=o[1],d=(0,u.useRef)(new Set([])),s=(0,u.useMemo)((function(){if(null!==e){var n=(Array.isArray(e)?e:[e]).filter((function(e){return"string"==typeof e})).map((function(e){return e.split("+")})),t=n.reduce((function(e,n){return e.concat.apply(e,(0,l.Z)(n))}),[]);return[n,t]}return[[],[]]}),[e]),c=(0,a.Z)(s,2),g=c[0],f=c[1];return(0,u.useEffect)((function(){if(null!==e){var t,o,r=function(e){if(An(e))return!1;var n=Zn(e.code,f);d.current.add(e[n]),Dn(g,d.current,!1)&&(e.preventDefault(),i(!0))},a=function(e){if(An(e))return!1;var n=Zn(e.code,f);Dn(g,d.current,!0)?(i(!1),d.current.clear()):d.current.delete(e[n])},l=function(){d.current.clear(),i(!1)};return null==n||null===(t=n.target)||void 0===t||t.addEventListener("keydown",r),null==n||null===(o=n.target)||void 0===o||o.addEventListener("keyup",a),window.addEventListener("blur",l),function(){var e,t;null==n||null===(e=n.target)||void 0===e||e.removeEventListener("keydown",r),null==n||null===(t=n.target)||void 0===t||t.removeEventListener("keyup",a),window.removeEventListener("blur",l)}}}),[e,i]),r};function Dn(e,n,t){return e.filter((function(e){return t||e.length===n.size})).some((function(e){return e.every((function(e){return n.has(e)}))}))}function Zn(e,n){return n.includes(e)?"code":"key"}function An(e){var n,t=(null===(n=e.composedPath)||void 0===n?void 0:n.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(null==t?void 0:t.nodeName)||(null==t?void 0:t.hasAttribute("contenteditable"))||!(null==t||!t.closest(".nokey"))}function Bn(e,n,t,o){var r,i,a,l,d,s,c,u,g,f,v,p;if(!e.parentNode)return o;var h=n.get(e.parentNode);return Bn(h,n,t,{x:(null!==(r=o.x)&&void 0!==r?r:0)+(null!==(i=null===(a=h.position)||void 0===a?void 0:a.x)&&void 0!==i?i:0),y:(null!==(l=o.y)&&void 0!==l?l:0)+(null!==(d=null===(s=h.position)||void 0===s?void 0:s.y)&&void 0!==d?d:0),z:(null!==(c=null===(u=h[ne])||void 0===u?void 0:u.z)&&void 0!==c?c:0)>(null!==(g=o.z)&&void 0!==g?g:0)?null!==(f=null===(v=h[ne])||void 0===v?void 0:v.z)&&void 0!==f?f:0:null!==(p=o.z)&&void 0!==p?p:0})}function Ln(e,n){var t=new Map,o={};return e.forEach((function(e){var r,i=ee(e.zIndex)?e.zIndex:e.selected?1e3:0,a=n.get(e.id),l=N(N({width:null==a?void 0:a.width,height:null==a?void 0:a.height},e),{},{positionAbsolute:{x:e.position.x,y:e.position.y}});e.parentNode&&(l.parentNode=e.parentNode,o[e.parentNode]=!0),Object.defineProperty(l,ne,{enumerable:!1,value:{handleBounds:null==a||null===(r=a[ne])||void 0===r?void 0:r.handleBounds,z:i}}),t.set(e.id,l)})),t.forEach((function(e){if(e.parentNode&&!t.has(e.parentNode))throw new Error("Parent node ".concat(e.parentNode," not found"));if(e.parentNode||o[e.id]){var n,r,i=Bn(e,t,o,N(N({},e.position),{},{z:null!==(n=null===(r=e[ne])||void 0===r?void 0:r.z)&&void 0!==n?n:0})),a=i.x,l=i.y,d=i.z;e.positionAbsolute={x:a,y:l},e[ne].z=d,o[e.id]&&(e[ne].isParent=!0)}})),t}function zn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e(),o=t.nodeInternals,r=t.width,i=t.height,l=t.minZoom,d=t.maxZoom,s=t.d3Zoom,c=t.d3Selection,u=t.fitViewOnInitDone,g=t.fitViewOnInit;if((n.initial&&!u&&g||!n.initial)&&s&&c){var f=Array.from(o.values()).filter((function(e){return n.includeHiddenNodes?e.width&&e.height:!e.hidden})),v=f.every((function(e){return e.width&&e.height}));if(f.length>0&&v){var p,h,m,y=Me(f),S=Ie(y,r,i,null!==(p=n.minZoom)&&void 0!==p?p:l,null!==(h=n.maxZoom)&&void 0!==h?h:d,null!==(m=n.padding)&&void 0!==m?m:.1),b=(0,a.Z)(S,3),C=b[0],E=b[1],w=b[2],N=x.CR.translate(C,E).scale(w);return"number"==typeof n.duration&&n.duration>0?s.transform(Oe(c,n.duration),N):s.transform(c,N),!0}}return!1}function _n(e,n){return e.forEach((function(e){var t,o=n.get(e.id);o&&n.set(o.id,N(N({},o),{},(t={},(0,d.Z)(t,ne,o[ne]),(0,d.Z)(t,"selected",e.selected),t)))})),new Map(n)}function jn(e,n){return n.map((function(n){var t=e.find((function(e){return e.id===n.id}));return t&&(n.selected=t.selected),n}))}function Rn(e){var n=e.changedNodes,t=e.changedEdges,o=e.get,r=e.set,i=o(),a=i.nodeInternals,l=i.edges,d=i.onNodesChange,s=i.onEdgesChange,c=i.hasDefaultNodes,u=i.hasDefaultEdges;null!=n&&n.length&&(c&&r({nodeInternals:_n(n,a)}),null==d||d(n)),null!=t&&t.length&&(u&&r({edges:jn(t,l)}),null==s||s(t))}var Tn=function(){},Yn={zoomIn:Tn,zoomOut:Tn,zoomTo:Tn,getZoom:function(){return 1},setViewport:Tn,getViewport:function(){return{x:0,y:0,zoom:1}},fitView:Tn,setCenter:Tn,fitBounds:Tn,project:function(e){return e},viewportInitialized:!1},Hn=function(e){return{d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}},Xn=function(){var e=O(),n=I(Hn,p.Z),t=n.d3Zoom,o=n.d3Selection;return(0,u.useMemo)((function(){return o&&t?{zoomIn:function(e){return t.scaleBy(Oe(o,null==e?void 0:e.duration),1.2)},zoomOut:function(e){return t.scaleBy(Oe(o,null==e?void 0:e.duration),1/1.2)},zoomTo:function(e,n){return t.scaleTo(Oe(o,null==n?void 0:n.duration),e)},getZoom:function(){return e.getState().transform[2]},setViewport:function(n,r){var i,l,d,s=(0,a.Z)(e.getState().transform,3),c=s[0],u=s[1],g=s[2],f=x.CR.translate(null!==(i=n.x)&&void 0!==i?i:c,null!==(l=n.y)&&void 0!==l?l:u).scale(null!==(d=n.zoom)&&void 0!==d?d:g);t.transform(Oe(o,null==r?void 0:r.duration),f)},getViewport:function(){var n=(0,a.Z)(e.getState().transform,3);return{x:n[0],y:n[1],zoom:n[2]}},fitView:function(n){return zn(e.getState,n)},setCenter:function(n,r,i){var a=e.getState(),l=a.width,d=a.height,s=a.maxZoom,c=void 0!==(null==i?void 0:i.zoom)?i.zoom:s,u=l/2-n*c,g=d/2-r*c,f=x.CR.translate(u,g).scale(c);t.transform(Oe(o,null==i?void 0:i.duration),f)},fitBounds:function(n,r){var i,l=e.getState(),d=l.width,s=l.height,c=l.minZoom,u=l.maxZoom,g=Ie(n,d,s,c,u,null!==(i=null==r?void 0:r.padding)&&void 0!==i?i:.1),f=(0,a.Z)(g,3),v=f[0],p=f[1],h=f[2],m=x.CR.translate(v,p).scale(h);t.transform(Oe(o,null==r?void 0:r.duration),m)},project:function(n){var t=e.getState();return function(e,n,t,o){var r=e.x,i=e.y,l=(0,a.Z)(n,3),d=l[0],s=l[1],c=l[2],u=(0,a.Z)(o,2),g=u[0],f=u[1],v={x:(r-d)/c,y:(i-s)/c};return t?{x:g*Math.round(v.x/g),y:f*Math.round(v.y/f)}:v}(n,t.transform,t.snapToGrid,t.snapGrid)},viewportInitialized:!0}:Yn}),[t,o])};function Vn(){var e=Xn(),n=O(),t=(0,u.useCallback)((function(){var e=n.getState().nodeInternals;return Array.from(e.values()).map((function(e){return N({},e)}))}),[]),o=(0,u.useCallback)((function(e){return n.getState().nodeInternals.get(e)}),[]),r=(0,u.useCallback)((function(){var e=n.getState().edges;return(void 0===e?[]:e).map((function(e){return N({},e)}))}),[]),i=(0,u.useCallback)((function(e){var t=n.getState().edges;return(void 0===t?[]:t).find((function(n){return n.id===e}))}),[]),d=(0,u.useCallback)((function(e){var t=n.getState(),o=t.nodeInternals,r=t.setNodes,i=t.hasDefaultNodes,a=t.onNodesChange,l=Array.from(o.values()),d="function"==typeof e?e(l):e;if(i)r(d);else if(a){a(0===d.length?l.map((function(e){return{type:"remove",id:e.id}})):d.map((function(e){return{item:e,type:"reset"}})))}}),[]),s=(0,u.useCallback)((function(e){var t=n.getState(),o=t.edges,r=void 0===o?[]:o,i=t.setEdges,a=t.hasDefaultEdges,l=t.onEdgesChange,d="function"==typeof e?e(r):e;if(a)i(d);else if(l){l(0===d.length?r.map((function(e){return{type:"remove",id:e.id}})):d.map((function(e){return{item:e,type:"reset"}})))}}),[]),c=(0,u.useCallback)((function(e){var t=Array.isArray(e)?e:[e],o=n.getState(),r=o.nodeInternals,i=o.setNodes,a=o.hasDefaultNodes,d=o.onNodesChange;if(a){var s=Array.from(r.values());i([].concat(s,(0,l.Z)(t)))}else if(d){d(t.map((function(e){return{item:e,type:"add"}})))}}),[]),g=(0,u.useCallback)((function(e){var t=Array.isArray(e)?e:[e],o=n.getState(),r=o.edges,i=void 0===r?[]:r,a=o.setEdges,d=o.hasDefaultEdges,s=o.onEdgesChange;if(d)a([].concat((0,l.Z)(i),(0,l.Z)(t)));else if(s){s(t.map((function(e){return{item:e,type:"add"}})))}}),[]),f=(0,u.useCallback)((function(){var e=n.getState(),t=e.nodeInternals,o=e.edges,r=void 0===o?[]:o,i=e.transform,l=Array.from(t.values()),d=(0,a.Z)(i,3),s=d[0],c=d[1],u=d[2];return{nodes:l.map((function(e){return N({},e)})),edges:r.map((function(e){return N({},e)})),viewport:{x:s,y:c,zoom:u}}}),[]),v=(0,u.useCallback)((function(e){var t=e.nodes,o=e.edges,r=n.getState(),i=r.nodeInternals,a=r.edges,d=r.hasDefaultNodes,s=r.hasDefaultEdges,c=r.onNodesDelete,u=r.onEdgesDelete,g=r.onNodesChange,f=r.onEdgesChange,v=Array.from(i.values()),p=(t||[]).map((function(e){return e.id})),h=(o||[]).map((function(e){return e.id})),m=v.reduce((function(e,n){var t=!p.includes(n.id)&&n.parentNode&&e.find((function(e){return e.id===n.parentNode}));return("boolean"!=typeof n.deletable||n.deletable)&&(p.includes(n.id)||t)&&e.push(n),e}),[]),y=a.filter((function(e){return"boolean"!=typeof e.deletable||e.deletable})),x=y.filter((function(e){return h.includes(e.id)}));if(m||x){var S=ke(m,y),b=[].concat((0,l.Z)(x),(0,l.Z)(S)),C=b.reduce((function(e,n){return e.includes(n.id)||e.push(n.id),e}),[]);if((s||d)&&(s&&n.setState({edges:a.filter((function(e){return!C.includes(e.id)}))}),d&&(m.forEach((function(e){i.delete(e.id)})),n.setState({nodeInternals:new Map(i)}))),C.length>0&&(null==u||u(b),f&&f(C.map((function(e){return{id:e,type:"remove"}})))),m.length>0)if(null==c||c(m),g)g(m.map((function(e){return{id:e.id,type:"remove"}})))}}),[]),p=(0,u.useCallback)((function(e){var t,o=!!((t=e).width&&t.height&&t.x&&t.y),r=o?null:n.getState().nodeInternals.get(e.id);return[o?e:Q(r),r,o]}),[]),h=(0,u.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2?arguments[2]:void 0,r=p(e),i=(0,a.Z)(r,3),l=i[0],d=i[1],s=i[2];return l?(o||Array.from(n.getState().nodeInternals.values())).filter((function(n){if(!(s||n.id!==d.id&&n.positionAbsolute))return!1;var o=Q(n),r=J(o,l);return t&&r>0||r>=e.width*e.height})):[]}),[]),m=(0,u.useCallback)((function(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=p(e),r=(0,a.Z)(o,1),i=r[0];if(!i)return!1;var l=J(i,n),d=t&&l>0;return d||l>=e.width*e.height}),[]);return(0,u.useMemo)((function(){return N(N({},e),{},{getNodes:t,getNode:o,getEdges:r,getEdge:i,setNodes:d,setEdges:s,addNodes:c,addEdges:g,toObject:f,deleteElements:v,getIntersectingNodes:h,isNodeIntersecting:m})}),[e,t,o,r,i,d,s,c,g,f,v,h,m])}var Kn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Un=function(e){return{x:e.x,y:e.y,zoom:e.k}},Fn=function(e,n){return e.target.closest(".".concat(n))},Wn=function(e){return{d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler}},Gn=function(e){var n=e.onMove,t=e.onMoveStart,o=e.onMoveEnd,r=e.zoomOnScroll,i=void 0===r||r,a=e.zoomOnPinch,l=void 0===a||a,d=e.panOnScroll,s=void 0!==d&&d,g=e.panOnScrollSpeed,f=void 0===g?.5:g,v=e.panOnScrollMode,h=void 0===v?_.Free:v,S=e.zoomOnDoubleClick,b=void 0===S||S,C=e.selectionKeyPressed,E=e.elementsSelectable,w=e.panOnDrag,N=void 0===w||w,M=e.defaultViewport,P=e.translateExtent,k=e.minZoom,D=e.maxZoom,Z=e.zoomActivationKeyCode,A=e.preventScrolling,B=void 0===A||A,L=e.children,z=e.noWheelClassName,j=e.noPanClassName,R=(0,u.useRef)(),T=O(),Y=(0,u.useRef)(!1),H=(0,u.useRef)(null),X=(0,u.useRef)({x:0,y:0,zoom:0}),U=I(Wn,p.Z),F=U.d3Zoom,W=U.d3Selection,G=U.d3ZoomHandler,q=On(Z);return function(e){var n=O();(0,u.useEffect)((function(){var t,o=function(){if(e.current){var t=V(e.current);0!==t.height&&0!==t.width||oe(),n.setState({width:t.width||500,height:t.height||500})}};return o(),window.addEventListener("resize",o),e.current&&(t=new ResizeObserver((function(){return o()}))).observe(e.current),function(){window.removeEventListener("resize",o),t&&e.current&&t.unobserve(e.current)}}),[])}(H),(0,u.useEffect)((function(){if(H.current){var e=(0,x.sP)().scaleExtent([k,D]).translateExtent(P),n=(0,m.Z)(H.current).call(e),t=K(M.x,P[0][0],P[1][0]),o=K(M.y,P[0][1],P[1][1]),r=K(M.zoom,k,D),i=x.CR.translate(t,o).scale(r);e.transform(n,i),T.setState({d3Zoom:e,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[t,o,r],domNode:H.current.closest(".react-flow")})}}),[]),(0,u.useEffect)((function(){W&&F&&(s&&!q?W.on("wheel.zoom",(function(e){if(Fn(e,z))return!1;e.preventDefault(),e.stopImmediatePropagation();var n=W.property("__zoom").k||1;if(e.ctrlKey&&l){var t=(0,y.Z)(e),o=-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*10,r=n*Math.pow(2,o);F.scaleTo(W,r,t)}else{var i=1===e.deltaMode?20:1,a=h===_.Vertical?0:e.deltaX*i,d=h===_.Horizontal?0:e.deltaY*i;F.translateBy(W,-a/n*f,-d/n*f)}})):void 0!==G&&W.on("wheel.zoom",(function(e,n){if(!B||Fn(e,z))return null;e.preventDefault(),G.call(this,e,n)})))}),[s,h,W,F,G,q,l,B,z]),(0,u.useEffect)((function(){F&&(C&&!Y.current?F.on("zoom",null):C||F.on("zoom",(function(e){var t=T.getState().onViewportChange;if(T.setState({transform:[e.transform.x,e.transform.y,e.transform.k]}),n||t){var o=Un(e.transform);null==t||t(o),null==n||n(e.sourceEvent,o)}})))}),[C,F,n]),(0,u.useEffect)((function(){F&&F.on("start",(function(e){var n;if(!e.sourceEvent)return null;var o=T.getState().onViewportChangeStart;if(Y.current=!0,"mousedown"===(null===(n=e.sourceEvent)||void 0===n?void 0:n.type)&&T.setState({paneDragging:!0}),t||o){var r=Un(e.transform);X.current=r,null==o||o(r),null==t||t(e.sourceEvent,r)}}))}),[F,t]),(0,u.useEffect)((function(){F&&F.on("end",(function(e){if(!e.sourceEvent)return null;var n,t,r=T.getState().onViewportChangeEnd;if(Y.current=!1,T.setState({paneDragging:!1}),(o||r)&&(n=X.current,t=e.transform,n.x!==t.x||n.y!==t.y||n.zoom!==t.k)){var i=Un(e.transform);X.current=i,clearTimeout(R.current),R.current=setTimeout((function(){null==r||r(i),null==o||o(e.sourceEvent,i)}),s?150:0)}}))}),[F,o,s]),(0,u.useEffect)((function(){F&&F.filter((function(e){var n=q||i,t=l&&e.ctrlKey;return!(1!==e.button||"mousedown"!==e.type||!e.target.closest(".react-flow__node"))||!!(N||n||s||b||l)&&(!C&&(!(!b&&"dblclick"===e.type)&&((!Fn(e,z)||"wheel"!==e.type)&&((!Fn(e,j)||"wheel"===e.type)&&(!(!l&&e.ctrlKey&&"wheel"===e.type)&&(!!(n||s||t||"wheel"!==e.type)&&(!!(N||"mousedown"!==e.type&&"touchstart"!==e.type)&&((!e.ctrlKey||"wheel"===e.type)&&(!e.button||e.button<=1)))))))))}))}),[F,i,l,s,b,N,C,E,q]),(0,c.jsx)("div",{className:"react-flow__renderer",ref:H,style:Kn,children:L})};function qn(e,n){var t=e.find((function(e){return e.id===n.parentNode}));if(t){var o=n.position.x+n.width-t.width,r=n.position.y+n.height-t.height;if(o>0||r>0||n.position.x<0||n.position.y<0){var i,a;if(t.style=N({},t.style)||{},t.style.width=null!==(i=t.style.width)&&void 0!==i?i:t.width,t.style.height=null!==(a=t.style.height)&&void 0!==a?a:t.height,o>0&&(t.style.width+=o),r>0&&(t.style.height+=r),n.position.x<0){var l=Math.abs(n.position.x);t.position.x=t.position.x-l,t.style.width+=l,n.position.x=0}if(n.position.y<0){var d=Math.abs(n.position.y);t.position.y=t.position.y-d,t.style.height+=d,n.position.y=0}t.width=t.style.width,t.height=t.style.height}}}function Qn(e,n){if(e.some((function(e){return"reset"===e.type})))return e.filter((function(e){return"reset"===e.type})).map((function(e){return e.item}));var t=e.filter((function(e){return"add"===e.type})).map((function(e){return e.item}));return n.reduce((function(n,t){var o=e.find((function(e){return e.id===t.id}));if(o)switch(o.type){case"select":return n.push(N(N({},t),{},{selected:o.selected})),n;case"position":var r=N({},t);return void 0!==o.position&&(r.position=o.position),void 0!==o.positionAbsolute&&(r.positionAbsolute=o.positionAbsolute),void 0!==o.dragging&&(r.dragging=o.dragging),r.expandParent&&qn(n,r),n.push(r),n;case"dimensions":var i=N({},t);return void 0!==o.dimensions&&(i.width=o.dimensions.width,i.height=o.dimensions.height),i.expandParent&&qn(n,i),n.push(i),n;case"remove":return n}return n.push(t),n}),t)}function $n(e,n){return Qn(e,n)}var Jn=function(e,n){return{id:e,type:"select",selected:n}};function et(e,n){return e.reduce((function(e,t){var o=n.includes(t.id);return!t.selected&&o?(t.selected=!0,e.push(Jn(t.id,!0))):t.selected&&!o&&(t.selected=!1,e.push(Jn(t.id,!1))),e}),[])}function nt(e,n){return{x:e.clientX-n.left,y:e.clientY-n.top}}var tt=function(e){return{userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable}},ot={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},rt=(0,u.memo)((function(e){var n=e.selectionKeyPressed,t=O(),o=(0,u.useRef)(0),r=(0,u.useRef)(0),i=(0,u.useRef)(),l=(0,u.useState)(ot),d=(0,a.Z)(l,2),s=d[0],g=d[1],f=I(tt,p.Z),v=f.userSelectionActive;if(!f.elementsSelectable||!(v||n))return null;var h=function(){g(ot),t.setState({userSelectionActive:!1}),o.current=0,r.current=0};return(0,c.jsx)("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:function(e){var n=e.target.closest(".react-flow");i.current=n.getBoundingClientRect();var o=nt(e,i.current);g({width:0,height:0,startX:o.x,startY:o.y,x:o.x,y:o.y,draw:!0}),t.setState({userSelectionActive:!0,nodesSelectionActive:!1})},onMouseMove:function(e){var a,l;if(n&&s.draw&&i.current){var d=nt(e,i.current),c=null!==(a=s.startX)&&void 0!==a?a:0,u=null!==(l=s.startY)&&void 0!==l?l:0,f=N(N({},s),{},{x:d.x<c?d.x:c,y:d.y<u?d.y:u,width:Math.abs(d.x-c),height:Math.abs(d.y-u)}),v=t.getState(),p=v.nodeInternals,h=v.edges,m=v.transform,y=v.onNodesChange,x=v.onEdgesChange,S=Array.from(p.values()),b=Pe(p,f,m,!1,!0),C=ke(b,h).map((function(e){return e.id})),E=b.map((function(e){return e.id}));if(o.current!==E.length){o.current=E.length;var w=et(S,E);w.length&&(null==y||y(w))}if(r.current!==C.length){r.current=C.length;var M=et(h,C);M.length&&(null==x||x(M))}g(f)}},onMouseUp:function(){t.setState({nodesSelectionActive:o.current>0}),h()},onMouseLeave:function(){t.setState({nodesSelectionActive:!1}),h()},children:s.draw&&(0,c.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:s.width,height:s.height,transform:"translate(".concat(s.x,"px, ").concat(s.y,"px)")}})})}));rt.displayName="UserSelection";var it=function(e){return N({transformString:"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")"),userSelectionActive:e.userSelectionActive},Me(Array.from(e.nodeInternals.values()).filter((function(e){return e.selected}))))},at=function(e){var n=Array.from(e.nodeInternals.values()).filter((function(e){return e.selected}));return Me(n)};var lt=(0,u.memo)((function(e){var n=e.onSelectionContextMenu,t=e.noPanClassName,o=e.disableKeyboardA11y,r=O(),i=I(it,p.Z),a=i.transformString,l=i.userSelectionActive,d=I(at,p.Z),s=d.width,f=d.height,v=d.x,h=d.y,m=Nn(),y=(0,u.useRef)(null);if((0,u.useEffect)((function(){var e;o||(null===(e=y.current)||void 0===e||e.focus())}),[o]),wn({nodeRef:y}),l||!s||!f)return null;var x=n?function(e){var t=Array.from(r.getState().nodeInternals.values()).filter((function(e){return e.selected}));n(e,t)}:void 0;return(0,c.jsx)("div",{className:(0,g.Z)(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:(0,c.jsx)("div",{ref:y,className:"react-flow__nodesselection-rect",onContextMenu:x,tabIndex:o?void 0:-1,onKeyDown:o?void 0:function(e){Object.prototype.hasOwnProperty.call(Mn,e.key)&&m(Mn[e.key])},style:{width:s,height:f,top:h,left:v}})})})),dt=function(e){return e.paneDragging};function st(e){var n=e.onClick,t=e.onMouseEnter,o=e.onMouseMove,r=e.onMouseLeave,i=e.onContextMenu,a=e.onWheel,l=I(dt);return(0,c.jsx)("div",{className:(0,g.Z)(["react-flow__pane",{dragging:l}]),onClick:n,onMouseEnter:t,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onWheel:a,style:Kn})}var ct=function(e){return e.nodesSelectionActive},ut=function(e){var n=e.children,t=e.onPaneClick,o=e.onPaneMouseEnter,r=e.onPaneMouseMove,i=e.onPaneMouseLeave,a=e.onPaneContextMenu,l=e.onPaneScroll,d=e.deleteKeyCode,s=e.onMove,g=e.onMoveStart,f=e.onMoveEnd,v=e.selectionKeyCode,p=e.multiSelectionKeyCode,h=e.zoomActivationKeyCode,m=e.elementsSelectable,y=e.zoomOnScroll,x=e.zoomOnPinch,S=e.panOnScroll,b=e.panOnScrollSpeed,C=e.panOnScrollMode,E=e.zoomOnDoubleClick,w=e.panOnDrag,N=e.defaultViewport,M=e.translateExtent,P=e.minZoom,k=e.maxZoom,D=e.preventScrolling,Z=e.onSelectionContextMenu,A=e.noWheelClassName,B=e.noPanClassName,L=e.disableKeyboardA11y,z=O(),_=I(ct),j=On(v);!function(e){var n=e.deleteKeyCode,t=e.multiSelectionKeyCode,o=O(),r=Vn().deleteElements,i=On(n),a=On(t);(0,u.useEffect)((function(){if(i){var e=o.getState(),n=e.nodeInternals,t=e.edges,a=Array.from(n.values()).filter((function(e){return e.selected})),l=t.filter((function(e){return e.selected}));r({nodes:a,edges:l}),o.setState({nodesSelectionActive:!1})}}),[i]),(0,u.useEffect)((function(){o.setState({multiSelectionActive:a})}),[a])}({deleteKeyCode:d,multiSelectionKeyCode:p});var R=a?function(e){return a(e)}:void 0,T=l?function(e){return l(e)}:void 0;return(0,c.jsxs)(Gn,{onMove:s,onMoveStart:g,onMoveEnd:f,selectionKeyPressed:j,elementsSelectable:m,zoomOnScroll:y,zoomOnPinch:x,panOnScroll:S,panOnScrollSpeed:b,panOnScrollMode:C,zoomOnDoubleClick:E,panOnDrag:w,defaultViewport:N,translateExtent:M,minZoom:P,maxZoom:k,zoomActivationKeyCode:h,preventScrolling:D,noWheelClassName:A,noPanClassName:B,children:[n,(0,c.jsx)(rt,{selectionKeyPressed:j}),_&&(0,c.jsx)(lt,{onSelectionContextMenu:Z,noPanClassName:B,disableKeyboardA11y:L}),(0,c.jsx)(st,{onClick:function(e){null==t||t(e),z.getState().resetSelectedElements(),z.setState({nodesSelectionActive:!1})},onMouseEnter:o,onMouseMove:r,onMouseLeave:i,onContextMenu:R,onWheel:T})]})};ut.displayName="FlowRenderer";var gt=(0,u.memo)(ut);var ft=function(e){return{nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions}},vt=function(e){var n,t=I(ft,p.Z),o=t.nodesDraggable,r=t.nodesConnectable,i=t.nodesFocusable,a=t.elementsSelectable,l=t.updateNodeDimensions,d=(n=e.onlyRenderVisibleElements,I((0,u.useCallback)((function(e){return n?Pe(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):Array.from(e.nodeInternals.values())}),[n]))),s=(0,u.useRef)(),g=(0,u.useMemo)((function(){if("undefined"==typeof ResizeObserver)return null;var e=new ResizeObserver((function(e){var n=e.map((function(e){return{id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0}}));l(n)}));return s.current=e,e}),[]);return(0,u.useEffect)((function(){return function(){var e;null==s||null===(e=s.current)||void 0===e||e.disconnect()}}),[]),(0,c.jsx)("div",{className:"react-flow__nodes",style:Kn,children:d.map((function(n){var t,l,d,s,u,f,v,p=n.type||"default";e.nodeTypes[p]||(oe('Node type "'.concat(p,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),p="default");var h,m,y,x,S,b,C=e.nodeTypes[p]||e.nodeTypes.default,E=!!(n.draggable||o&&void 0===n.draggable),w=!!(n.selectable||a&&void 0===n.selectable),N=!!(n.connectable||r&&void 0===n.connectable),M=!!(n.focusable||i&&void 0===n.focusable),P=e.nodeExtent?U(n.positionAbsolute,e.nodeExtent):n.positionAbsolute,k=null!==(t=null==P?void 0:P.x)&&void 0!==t?t:0,I=null!==(l=null==P?void 0:P.y)&&void 0!==l?l:0,O=(h={x:k,y:I,width:null!==(d=n.width)&&void 0!==d?d:0,height:null!==(s=n.height)&&void 0!==s?s:0,origin:e.nodeOrigin},m=h.x,y=h.y,x=h.width,S=h.height,b=h.origin,x&&S?b[0]<0||b[1]<0||b[0]>1||b[1]>1?(oe(),{x:m,y:y}):{x:m-x*b[0],y:y-S*b[1]}:{x:m,y:y});return(0,c.jsx)(C,{id:n.id,className:n.className,style:n.style,type:p,data:n.data,sourcePosition:n.sourcePosition||X.Bottom,targetPosition:n.targetPosition||X.Top,hidden:n.hidden,xPos:k,yPos:I,xPosOrigin:O.x,yPosOrigin:O.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!n.selected,isDraggable:E,isSelectable:w,isConnectable:N,isFocusable:M,resizeObserver:g,dragHandle:n.dragHandle,zIndex:null!==(u=null===(f=n[ne])||void 0===f?void 0:f.z)&&void 0!==u?u:0,isParent:!(null===(v=n[ne])||void 0===v||!v.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!n.width&&!!n.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:n.ariaLabel},n.id)}))})};vt.displayName="NodeRenderer";var pt=(0,u.memo)(vt),ht=[{level:0,isMaxLevel:!0,edges:[]}];function mt(e,n,t){return function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=-1,r=e.reduce((function(e,r){var i,a,l,d,s=ee(r.zIndex),c=s?r.zIndex:0;return t&&(c=s?r.zIndex:Math.max((null===(i=n.get(r.source))||void 0===i||null===(a=i[ne])||void 0===a?void 0:a.z)||0,(null===(l=n.get(r.target))||void 0===l||null===(d=l[ne])||void 0===d?void 0:d.z)||0)),e[c]?e[c].push(r):e[c]=[r],o=c>o?c:o,e}),{}),i=Object.entries(r).map((function(e){var n=(0,a.Z)(e,2),t=+n[0];return{edges:n[1],level:t,isMaxLevel:t===o}}));return 0===i.length?ht:i}(I((0,u.useCallback)((function(t){return e?t.edges.filter((function(e){var o=n.get(e.source),r=n.get(e.target);return(null==o?void 0:o.width)&&(null==o?void 0:o.height)&&(null==r?void 0:r.width)&&(null==r?void 0:r.height)&&function(e){var n=e.sourcePos,t=e.targetPos,o=e.sourceWidth,r=e.sourceHeight,i=e.targetWidth,a=e.targetHeight,l=e.width,d=e.height,s=e.transform,c={x:Math.min(n.x,t.x),y:Math.min(n.y,t.y),x2:Math.max(n.x+o,t.x+i),y2:Math.max(n.y+r,t.y+a)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);var u=G({x:(0-s[0])/s[2],y:(0-s[1])/s[2],width:l/s[2],height:d/s[2]}),g=Math.max(0,Math.min(u.x2,c.x2)-Math.max(u.x,c.x)),f=Math.max(0,Math.min(u.y2,c.y2)-Math.max(u.y,c.y));return Math.ceil(g*f)>0}({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:r.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:r.width,targetHeight:r.height,width:t.width,height:t.height,transform:t.transform})})):t.edges}),[e,n])),n,t)}var yt=(r={},(0,d.Z)(r,X.Left,X.Right),(0,d.Z)(r,X.Right,X.Left),(0,d.Z)(r,X.Top,X.Bottom),(0,d.Z)(r,X.Bottom,X.Top),r),xt=function(e){var n,t,o,r,i,l=e.connectionNodeId,d=e.connectionHandleType,s=e.connectionLineStyle,g=e.connectionLineType,f=void 0===g?Y.Bezier:g,v=e.isConnectable,h=e.CustomConnectionLineComponent,m=I((0,u.useCallback)((function(e){return{fromNode:e.nodeInternals.get(l),handleId:e.connectionHandleId,toX:(e.connectionPosition.x-e.transform[0])/e.transform[2],toY:(e.connectionPosition.y-e.transform[1])/e.transform[2]}}),[l]),p.Z),y=m.fromNode,x=m.handleId,S=m.toX,b=m.toY,C=null==y||null===(n=y[ne])||void 0===n?void 0:n.handleBounds;if(!y||!v||null==C||!C[d])return null;var E=C[d],w=x?E.find((function(e){return e.id===x})):E[0],M=w?w.x+w.width/2:(null!==(t=null==y?void 0:y.width)&&void 0!==t?t:0)/2,P=w?w.y+w.height/2:null!==(o=null==y?void 0:y.height)&&void 0!==o?o:0,k=((null==y||null===(r=y.positionAbsolute)||void 0===r?void 0:r.x)||0)+M,O=((null==y||null===(i=y.positionAbsolute)||void 0===i?void 0:i.y)||0)+P,D=null==w?void 0:w.position;if(!D)return null;var Z=yt[D];if(h)return(0,c.jsx)("g",{className:"react-flow__connection",children:(0,c.jsx)(h,{connectionLineType:f,connectionLineStyle:s,fromNode:y,fromHandle:w,fromX:k,fromY:O,toX:S,toY:b,fromPosition:D,toPosition:Z})});var A="",B={sourceX:k,sourceY:O,sourcePosition:D,targetX:S,targetY:b,targetPosition:Z};if(f===Y.Bezier){var L=he(B);A=(0,a.Z)(L,1)[0]}else if(f===Y.Step){var z=ce(N(N({},B),{},{borderRadius:0}));A=(0,a.Z)(z,1)[0]}else if(f===Y.SmoothStep){var _=ce(B);A=(0,a.Z)(_,1)[0]}else if(f===Y.SimpleBezier){var j=ie(B);A=(0,a.Z)(j,1)[0]}else A="M".concat(k,",").concat(O," ").concat(S,",").concat(b);return(0,c.jsx)("g",{className:"react-flow__connection",children:(0,c.jsx)("path",{d:A,fill:"none",className:"react-flow__connection-path",style:s})})};xt.displayName="ConnectionLine";var St=(i={},(0,d.Z)(i,H.Arrow,(function(e){var n=e.color,t=void 0===n?"none":n,o=e.strokeWidth,r=void 0===o?1:o;return(0,c.jsx)("polyline",{stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r,fill:"none",points:"-5,-4 0,0 -5,4"})})),(0,d.Z)(i,H.ArrowClosed,(function(e){var n=e.color,t=void 0===n?"none":n,o=e.strokeWidth,r=void 0===o?1:o;return(0,c.jsx)("polyline",{stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r,fill:t,points:"-5,-4 0,0 -5,4 -5,-4"})})),i);var bt=function(e){var n=e.id,t=e.type,o=e.color,r=e.width,i=void 0===r?12.5:r,a=e.height,l=void 0===a?12.5:a,d=e.markerUnits,s=void 0===d?"strokeWidth":d,g=e.strokeWidth,f=e.orient,v=void 0===f?"auto-start-reverse":f,p=function(e){return(0,u.useMemo)((function(){return Object.prototype.hasOwnProperty.call(St,e)?St[e]:(oe('Marker type "'.concat(e,"\" doesn't exist. Help: https://reactflow.dev/error#900")),null)}),[e])}(t);return p?(0,c.jsx)("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(i),markerHeight:"".concat(l),viewBox:"-10 -10 20 20",markerUnits:s,orient:v,refX:"0",refY:"0",children:(0,c.jsx)(p,{color:o,strokeWidth:g})}):null},Ct=function(e){var n=e.defaultColor,t=e.rfId,o=I((0,u.useCallback)(function(e){var n=e.defaultColor,t=e.rfId;return function(e){var o=[];return e.edges.reduce((function(e,r){return[r.markerStart,r.markerEnd].forEach((function(r){if(r&&"object"==typeof r){var i=we(r,t);o.includes(i)||(e.push(N({id:i,color:r.color||n},r)),o.push(i))}})),e}),[]).sort((function(e,n){return e.id.localeCompare(n.id)}))}}({defaultColor:n,rfId:t}),[n,t]),(function(e,n){return!(e.length!==n.length||e.some((function(e,t){return e.id!==n[t].id})))}));return(0,c.jsx)("defs",{children:o.map((function(e){return(0,c.jsx)(bt,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id)}))})};Ct.displayName="MarkerDefinitions";var Et=(0,u.memo)(Ct),wt=function(e){return{connectionNodeId:e.connectionNodeId,connectionHandleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals}},Nt=function(e){var n=I(wt,p.Z),t=n.connectionNodeId,o=n.connectionHandleType,r=n.nodesConnectable,i=n.edgesFocusable,l=n.elementsSelectable,d=n.width,s=n.height,u=n.connectionMode,f=n.nodeInternals,v=mt(e.onlyRenderVisibleElements,f,e.elevateEdgesOnSelect);if(!d)return null;var h=e.connectionLineType,m=e.defaultMarkerColor,y=e.connectionLineStyle,x=e.connectionLineComponent,S=e.connectionLineContainerStyle,b=t&&o;return(0,c.jsxs)(c.Fragment,{children:[v.map((function(n){var t=n.level,o=n.edges,r=n.isMaxLevel;return(0,c.jsxs)("svg",{style:{zIndex:t},width:d,height:s,className:"react-flow__edges react-flow__container",children:[r&&(0,c.jsx)(Et,{defaultColor:m,rfId:e.rfId}),(0,c.jsx)("g",{children:o.map((function(n){var t=vn(f.get(n.source)),o=(0,a.Z)(t,3),r=o[0],d=o[1],s=o[2],v=vn(f.get(n.target)),p=(0,a.Z)(v,3),h=p[0],m=p[1],y=p[2];if(!s||!y)return null;var x=n.type||"default";e.edgeTypes[x]||(oe('Edge type "'.concat(x,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),x="default");var S=e.edgeTypes[x]||e.edgeTypes.default,b=u===z.Strict?m.target:m.target||m.source,C=fn(d.source,n.sourceHandle||null),E=fn(b,n.targetHandle||null),w=(null==C?void 0:C.position)||X.Bottom,N=(null==E?void 0:E.position)||X.Top,M=!!(n.focusable||i&&void 0===n.focusable);if(!C||!E)return oe("Couldn't create edge for ".concat(C?"target":"source"," handle id: ").concat(C?n.targetHandle:n.sourceHandle,"; edge id: ").concat(n.id,". Help: https://reactflow.dev/error#800")),null;var P=function(e,n,t,o,r,i){var a=gn(t,e,n),l=gn(i,o,r);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}}(r,C,w,h,E,N),k=P.sourceX,I=P.sourceY,O=P.targetX,D=P.targetY;return(0,c.jsx)(S,{id:n.id,className:(0,g.Z)([n.className,e.noPanClassName]),type:x,data:n.data,selected:!!n.selected,animated:!!n.animated,hidden:!!n.hidden,label:n.label,labelStyle:n.labelStyle,labelShowBg:n.labelShowBg,labelBgStyle:n.labelBgStyle,labelBgPadding:n.labelBgPadding,labelBgBorderRadius:n.labelBgBorderRadius,style:n.style,source:n.source,target:n.target,sourceHandleId:n.sourceHandle,targetHandleId:n.targetHandle,markerEnd:n.markerEnd,markerStart:n.markerStart,sourceX:k,sourceY:I,targetX:O,targetY:D,sourcePosition:w,targetPosition:N,elementsSelectable:l,onEdgeUpdate:e.onEdgeUpdate,onContextMenu:e.onEdgeContextMenu,onMouseEnter:e.onEdgeMouseEnter,onMouseMove:e.onEdgeMouseMove,onMouseLeave:e.onEdgeMouseLeave,onClick:e.onEdgeClick,edgeUpdaterRadius:e.edgeUpdaterRadius,onEdgeDoubleClick:e.onEdgeDoubleClick,onEdgeUpdateStart:e.onEdgeUpdateStart,onEdgeUpdateEnd:e.onEdgeUpdateEnd,rfId:e.rfId,ariaLabel:n.ariaLabel,isFocusable:M,pathOptions:"pathOptions"in n?n.pathOptions:void 0,interactionWidth:n.interactionWidth},n.id)}))})]},t)})),b&&(0,c.jsx)("svg",{style:S,width:d,height:s,className:"react-flow__edges react-flow__connectionline react-flow__container",children:(0,c.jsx)(xt,{connectionNodeId:t,connectionHandleType:o,connectionLineStyle:y,connectionLineType:h,isConnectable:r,CustomConnectionLineComponent:x})})]})};Nt.displayName="EdgeRenderer";var Mt=(0,u.memo)(Nt),Pt=function(e){return"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")")};function kt(e){var n=e.children,t=I(Pt);return(0,c.jsx)("div",{className:"react-flow__viewport react-flow__container",style:{transform:t},children:n})}var It=function(e){var n=e.nodeTypes,t=e.edgeTypes,o=e.onMove,r=e.onMoveStart,i=e.onMoveEnd,a=e.onInit,l=e.onNodeClick,d=e.onEdgeClick,s=e.onNodeDoubleClick,g=e.onEdgeDoubleClick,f=e.onNodeMouseEnter,v=e.onNodeMouseMove,p=e.onNodeMouseLeave,h=e.onNodeContextMenu,m=e.onSelectionContextMenu,y=e.connectionLineType,x=e.connectionLineStyle,S=e.connectionLineComponent,b=e.connectionLineContainerStyle,C=e.selectionKeyCode,E=e.multiSelectionKeyCode,w=e.zoomActivationKeyCode,N=e.deleteKeyCode,M=e.onlyRenderVisibleElements,P=e.elementsSelectable,k=e.selectNodesOnDrag,I=e.defaultViewport,O=e.translateExtent,D=e.minZoom,Z=e.maxZoom,A=e.preventScrolling,B=e.defaultMarkerColor,L=e.zoomOnScroll,z=e.zoomOnPinch,_=e.panOnScroll,j=e.panOnScrollSpeed,R=e.panOnScrollMode,T=e.zoomOnDoubleClick,Y=e.panOnDrag,H=e.onPaneClick,X=e.onPaneMouseEnter,V=e.onPaneMouseMove,K=e.onPaneMouseLeave,U=e.onPaneScroll,F=e.onPaneContextMenu,W=e.onEdgeUpdate,G=e.onEdgeContextMenu,q=e.onEdgeMouseEnter,Q=e.onEdgeMouseMove,$=e.onEdgeMouseLeave,J=e.edgeUpdaterRadius,ee=e.onEdgeUpdateStart,ne=e.onEdgeUpdateEnd,te=e.noDragClassName,oe=e.noWheelClassName,re=e.noPanClassName,ie=e.elevateEdgesOnSelect,ae=e.disableKeyboardA11y,le=e.nodeOrigin,de=e.nodeExtent,se=e.rfId;return function(e){var n=Vn(),t=(0,u.useRef)(!1);(0,u.useEffect)((function(){!t.current&&n.viewportInitialized&&e&&(setTimeout((function(){return e(n)}),1),t.current=!0)}),[e,n.viewportInitialized])}(a),(0,c.jsx)(gt,{onPaneClick:H,onPaneMouseEnter:X,onPaneMouseMove:V,onPaneMouseLeave:K,onPaneContextMenu:F,onPaneScroll:U,deleteKeyCode:N,selectionKeyCode:C,multiSelectionKeyCode:E,zoomActivationKeyCode:w,elementsSelectable:P,onMove:o,onMoveStart:r,onMoveEnd:i,zoomOnScroll:L,zoomOnPinch:z,zoomOnDoubleClick:T,panOnScroll:_,panOnScrollSpeed:j,panOnScrollMode:R,panOnDrag:Y,defaultViewport:I,translateExtent:O,minZoom:D,maxZoom:Z,onSelectionContextMenu:m,preventScrolling:A,noDragClassName:te,noWheelClassName:oe,noPanClassName:re,disableKeyboardA11y:ae,children:(0,c.jsxs)(kt,{children:[(0,c.jsx)(Mt,{edgeTypes:t,onEdgeClick:d,onEdgeDoubleClick:g,connectionLineType:y,connectionLineStyle:x,connectionLineComponent:S,connectionLineContainerStyle:b,onEdgeUpdate:W,onlyRenderVisibleElements:M,onEdgeContextMenu:G,onEdgeMouseEnter:q,onEdgeMouseMove:Q,onEdgeMouseLeave:$,onEdgeUpdateStart:ee,onEdgeUpdateEnd:ne,edgeUpdaterRadius:J,defaultMarkerColor:B,noPanClassName:re,elevateEdgesOnSelect:!!ie,disableKeyboardA11y:ae,rfId:se}),(0,c.jsx)("div",{className:"react-flow__edgelabel-renderer",id:"edgelabel-portal"}),(0,c.jsx)(pt,{nodeTypes:n,onNodeClick:l,onNodeDoubleClick:s,onNodeMouseEnter:f,onNodeMouseMove:v,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:k,onlyRenderVisibleElements:M,noPanClassName:re,noDragClassName:te,disableKeyboardA11y:ae,nodeOrigin:le,nodeExtent:de,rfId:se})]})})};It.displayName="GraphView";var Ot=(0,u.memo)(It),Dt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Zt={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Dt,nodeExtent:Dt,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:z.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectOnClick:!0,ariaLiveMessage:""},At=function(e){var n=e.children,t=(0,u.useRef)(null);return t.current||(t.current=(0,v.Z)((function(e,n){return N(N({},Zt),{},{setNodes:function(t){e({nodeInternals:Ln(t,n().nodeInternals)})},setEdges:function(t){var o=n().defaultEdgeOptions,r=void 0===o?{}:o;e({edges:t.map((function(e){return N(N({},r),e)}))})},setDefaultNodesAndEdges:function(n,t){var o=void 0!==n,r=void 0!==t,i=o?Ln(n,new Map):new Map;e({nodeInternals:i,edges:r?t:[],hasDefaultNodes:o,hasDefaultEdges:r})},updateNodeDimensions:function(t){var o=n(),r=o.onNodesChange,i=o.nodeInternals,a=o.fitViewOnInit,l=o.fitViewOnInitDone,s=o.fitViewOnInitOptions,c=o.domNode,u=o.nodeOrigin,g=null==c?void 0:c.querySelector(".react-flow__viewport");if(g){var f=window.getComputedStyle(g),v=new window.DOMMatrixReadOnly(f.transform).m22,p=t.reduce((function(e,n){var t=i.get(n.id);if(t){var o=V(n.nodeElement);o.width&&o.height&&(t.width!==o.width||t.height!==o.height||n.forceUpdate)&&(i.set(t.id,N(N({},t),{},(0,d.Z)({},ne,N(N({},t[ne]),{},{handleBounds:{source:Sn(".source",n.nodeElement,v,u),target:Sn(".target",n.nodeElement,v,u)}})),o)),e.push({id:t.id,type:"dimensions",dimensions:o}))}return e}),[]),h=l||a&&!l&&zn(n,N({initial:!0},s));e({nodeInternals:new Map(i),fitViewOnInitDone:h}),(null==p?void 0:p.length)>0&&(null==r||r(p))}},updateNodePositions:function(t){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n(),a=i.onNodesChange,l=i.nodeInternals,d=i.hasDefaultNodes;if(d||a){var s=t.map((function(e){var n={id:e.id,type:"position",dragging:r};return o&&(n.positionAbsolute=e.positionAbsolute,n.position=e.position),n}));if(null!=s&&s.length){if(d){var c=Ln($n(s,Array.from(l.values())),l);e({nodeInternals:c})}null==a||a(s)}}},addSelectedNodes:function(t){var o,r=n(),i=r.multiSelectionActive,a=r.nodeInternals,l=r.edges,d=null;i?o=t.map((function(e){return Jn(e,!0)})):(o=et(Array.from(a.values()),t),d=et(l,[])),Rn({changedNodes:o,changedEdges:d,get:n,set:e})},addSelectedEdges:function(t){var o,r=n(),i=r.multiSelectionActive,a=r.edges,l=r.nodeInternals,d=null;i?o=t.map((function(e){return Jn(e,!0)})):(o=et(a,t),d=et(Array.from(l.values()),[])),Rn({changedNodes:d,changedEdges:o,get:n,set:e})},unselectNodesAndEdges:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.nodes,r=t.edges,i=n(),a=i.nodeInternals,l=i.edges,d=r||l;Rn({changedNodes:(o||Array.from(a.values())).map((function(e){return e.selected=!1,Jn(e.id,!1)})),changedEdges:d.map((function(e){return Jn(e.id,!1)})),get:n,set:e})},setMinZoom:function(t){var o=n(),r=o.d3Zoom,i=o.maxZoom;null==r||r.scaleExtent([t,i]),e({minZoom:t})},setMaxZoom:function(t){var o=n(),r=o.d3Zoom,i=o.minZoom;null==r||r.scaleExtent([i,t]),e({maxZoom:t})},setTranslateExtent:function(t){var o=n().d3Zoom;null==o||o.translateExtent(t),e({translateExtent:t})},resetSelectedElements:function(){var t=n(),o=t.nodeInternals,r=t.edges;Rn({changedNodes:Array.from(o.values()).filter((function(e){return e.selected})).map((function(e){return Jn(e.id,!1)})),changedEdges:r.filter((function(e){return e.selected})).map((function(e){return Jn(e.id,!1)})),get:n,set:e})},setNodeExtent:function(t){var o=n().nodeInternals;o.forEach((function(e){e.positionAbsolute=U(e.position,t)})),e({nodeExtent:t,nodeInternals:new Map(o)})},cancelConnection:function(){return e({connectionNodeId:Zt.connectionNodeId,connectionHandleId:Zt.connectionHandleId})},reset:function(){return e(N({},Zt))}})}))),(0,c.jsx)(P,{value:t.current,children:n})};At.displayName="ReactFlowProvider";var Bt=function(e){var n=e.children,t=!0;try{O()}catch(o){t=!1}return t?(0,c.jsx)(c.Fragment,{children:n}):(0,c.jsx)(At,{children:n})};function Lt(e,n){(0,u.useRef)(null);return(0,u.useMemo)((function(){return n(e)}),[e])}Bt.displayName="ReactFlowWrapper";var zt={input:je,default:ze,output:Te,group:Ye},_t={default:me,straight:fe,step:ge,smoothstep:ue,simplebezier:ae},jt=[0,0],Rt=[15,15],Tt={x:0,y:0,zoom:1},Yt={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Ht=(0,u.forwardRef)((function(e,n){var t=e.nodes,o=e.edges,r=e.defaultNodes,i=e.defaultEdges,a=e.className,l=e.nodeTypes,d=void 0===l?zt:l,u=e.edgeTypes,f=void 0===u?_t:u,v=e.onNodeClick,p=e.onEdgeClick,h=e.onInit,m=e.onMove,y=e.onMoveStart,x=e.onMoveEnd,S=e.onConnect,b=e.onConnectStart,C=e.onConnectEnd,w=e.onClickConnectStart,M=e.onClickConnectEnd,P=e.onNodeMouseEnter,k=e.onNodeMouseMove,I=e.onNodeMouseLeave,O=e.onNodeContextMenu,D=e.onNodeDoubleClick,Z=e.onNodeDragStart,B=e.onNodeDrag,L=e.onNodeDragStop,j=e.onNodesDelete,R=e.onEdgesDelete,T=e.onSelectionChange,H=e.onSelectionDragStart,X=e.onSelectionDrag,V=e.onSelectionDragStop,K=e.onSelectionContextMenu,U=e.connectionMode,F=void 0===U?z.Strict:U,W=e.connectionLineType,G=void 0===W?Y.Bezier:W,q=e.connectionLineStyle,Q=e.connectionLineComponent,$=e.connectionLineContainerStyle,J=e.deleteKeyCode,ee=void 0===J?"Backspace":J,ne=e.selectionKeyCode,te=void 0===ne?"Shift":ne,oe=e.multiSelectionKeyCode,re=void 0===oe?"Meta":oe,ie=e.zoomActivationKeyCode,ae=void 0===ie?"Meta":ie,le=e.snapToGrid,de=void 0!==le&&le,se=e.snapGrid,ce=void 0===se?Rt:se,ue=e.onlyRenderVisibleElements,ge=void 0!==ue&&ue,fe=e.selectNodesOnDrag,ve=void 0===fe||fe,pe=e.nodesDraggable,he=e.nodesConnectable,me=e.nodesFocusable,ye=e.nodeOrigin,xe=void 0===ye?jt:ye,Se=e.edgesFocusable,be=e.elementsSelectable,Ce=e.defaultViewport,Ee=void 0===Ce?Tt:Ce,we=e.minZoom,Ne=void 0===we?.5:we,Me=e.maxZoom,Pe=void 0===Me?2:Me,ke=e.translateExtent,Ie=void 0===ke?Dt:ke,Oe=e.preventScrolling,De=void 0===Oe||Oe,Ze=e.nodeExtent,Ae=e.defaultMarkerColor,Be=void 0===Ae?"#b1b1b7":Ae,Le=e.zoomOnScroll,ze=void 0===Le||Le,_e=e.zoomOnPinch,je=void 0===_e||_e,Re=e.panOnScroll,Te=void 0!==Re&&Re,Ye=e.panOnScrollSpeed,He=void 0===Ye?.5:Ye,Xe=e.panOnScrollMode,Ve=void 0===Xe?_.Free:Xe,Ke=e.zoomOnDoubleClick,Ue=void 0===Ke||Ke,We=e.panOnDrag,Ge=void 0===We||We,qe=e.onPaneClick,$e=e.onPaneMouseEnter,Je=e.onPaneMouseMove,en=e.onPaneMouseLeave,nn=e.onPaneScroll,tn=e.onPaneContextMenu,on=e.children,an=e.onEdgeUpdate,ln=e.onEdgeContextMenu,dn=e.onEdgeDoubleClick,sn=e.onEdgeMouseEnter,cn=e.onEdgeMouseMove,gn=e.onEdgeMouseLeave,fn=e.onEdgeUpdateStart,vn=e.onEdgeUpdateEnd,pn=e.edgeUpdaterRadius,hn=void 0===pn?10:pn,mn=e.onNodesChange,yn=e.onEdgesChange,xn=e.noDragClassName,Sn=void 0===xn?"nodrag":xn,bn=e.noWheelClassName,Cn=void 0===bn?"nowheel":bn,En=e.noPanClassName,wn=void 0===En?"nopan":En,Nn=e.fitView,Mn=void 0!==Nn&&Nn,Pn=e.fitViewOptions,In=e.connectOnClick,On=void 0===In||In,Dn=e.attributionPosition,Zn=e.proOptions,An=e.defaultEdgeOptions,Bn=e.elevateEdgesOnSelect,Ln=void 0!==Bn&&Bn,zn=e.disableKeyboardA11y,_n=void 0!==zn&&zn,jn=e.style,Rn=e.id,Tn=(0,s.Z)(e,E),Yn=Lt(d,kn),Hn=Lt(f,un),Xn=Rn||"1";return(0,c.jsx)("div",N(N({},Tn),{},{style:N(N({},jn),Yt),ref:n,className:(0,g.Z)(["react-flow",a]),"data-testid":"rf__wrapper",id:Rn,children:(0,c.jsxs)(Bt,{children:[(0,c.jsx)(Ot,{onInit:h,onMove:m,onMoveStart:y,onMoveEnd:x,onNodeClick:v,onEdgeClick:p,onNodeMouseEnter:P,onNodeMouseMove:k,onNodeMouseLeave:I,onNodeContextMenu:O,onNodeDoubleClick:D,nodeTypes:Yn,edgeTypes:Hn,connectionLineType:G,connectionLineStyle:q,connectionLineComponent:Q,connectionLineContainerStyle:$,selectionKeyCode:te,deleteKeyCode:ee,multiSelectionKeyCode:re,zoomActivationKeyCode:ae,onlyRenderVisibleElements:ge,selectNodesOnDrag:ve,defaultViewport:Ee,translateExtent:Ie,minZoom:Ne,maxZoom:Pe,preventScrolling:De,zoomOnScroll:ze,zoomOnPinch:je,zoomOnDoubleClick:Ue,panOnScroll:Te,panOnScrollSpeed:He,panOnScrollMode:Ve,panOnDrag:Ge,onPaneClick:qe,onPaneMouseEnter:$e,onPaneMouseMove:Je,onPaneMouseLeave:en,onPaneScroll:nn,onPaneContextMenu:tn,onSelectionContextMenu:K,onEdgeUpdate:an,onEdgeContextMenu:ln,onEdgeDoubleClick:dn,onEdgeMouseEnter:sn,onEdgeMouseMove:cn,onEdgeMouseLeave:gn,onEdgeUpdateStart:fn,onEdgeUpdateEnd:vn,edgeUpdaterRadius:hn,defaultMarkerColor:Be,noDragClassName:Sn,noWheelClassName:Cn,noPanClassName:wn,elevateEdgesOnSelect:Ln,rfId:Xn,disableKeyboardA11y:_n,nodeOrigin:xe,nodeExtent:Ze}),(0,c.jsx)(Qe,{nodes:t,edges:o,defaultNodes:r,defaultEdges:i,onConnect:S,onConnectStart:b,onConnectEnd:C,onClickConnectStart:w,onClickConnectEnd:M,nodesDraggable:pe,nodesConnectable:he,nodesFocusable:me,edgesFocusable:Se,elementsSelectable:be,minZoom:Ne,maxZoom:Pe,nodeExtent:Ze,onNodesChange:mn,onEdgesChange:yn,snapToGrid:de,snapGrid:ce,connectionMode:F,translateExtent:Ie,connectOnClick:On,defaultEdgeOptions:An,fitView:Mn,fitViewOptions:Pn,onNodesDelete:j,onEdgesDelete:R,onNodeDragStart:Z,onNodeDrag:B,onNodeDragStop:L,onSelectionDrag:X,onSelectionDragStart:H,onSelectionDragStop:V,noPanClassName:wn,nodeOrigin:xe,rfId:Xn}),(0,c.jsx)(Fe,{onSelectionChange:T}),on,(0,c.jsx)(A,{proOptions:Zn,position:Dn}),(0,c.jsx)(rn,{rfId:Xn,disableKeyboardA11y:_n})]})}))}));Ht.displayName="ReactFlow";function Xt(e){return function(n){var t=(0,u.useState)(n),o=(0,a.Z)(t,2),r=o[0],i=o[1],l=(0,u.useCallback)((function(n){return i((function(t){return e(n,t)}))}),[]);return[r,i,l]}}var Vt=Xt($n),Kt=Xt((function(e,n){return Qn(e,n)}))}}]);
//# sourceMappingURL=5a3f41a5-114c2828808e212157bf.js.map